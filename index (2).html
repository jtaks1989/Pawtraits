<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Pawtraits ‚Äî Renaissance Portraits</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,700;0,900;1,700;1,900&family=DM+Serif+Display:ital@0;1&family=Instrument+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --black:   #080808;
      --deep:    #0e0e0e;
      --surface: #161616;
      --card:    #111111;
      --border:  rgba(255,255,255,0.08);
      --bh:      rgba(255,255,255,0.15);
      --white:   #f4f0ea;
      --muted:   rgba(244,240,234,0.45);
      --teal:    #3ecfb2;
      --teal-dk: #2aab92;
      --gold:    #c8a84b;
      --red:     #e05555;
    }
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; }
    body { background: var(--black); color: var(--white); font-family: 'Instrument Sans', sans-serif; font-size: 16px; line-height: 1.6; overflow-x: hidden; min-height: 100vh; }
    body::after { content: ''; position: fixed; inset: 0; pointer-events: none; z-index: 9999; opacity: .026; background: url("data:image/svg+xml,%3Csvg viewBox='0 0 512 512' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='g'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.75' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23g)'/%3E%3C/svg%3E"); background-size: 200px; }

    /* ‚îÄ‚îÄ NAV ‚îÄ‚îÄ */
    nav { position: sticky; top: 0; z-index: 300; display: flex; align-items: center; justify-content: space-between; padding: .9rem 2rem; background: rgba(8,8,8,.94); backdrop-filter: blur(20px); border-bottom: 1px solid var(--border); }
    .logo { font-family: 'DM Serif Display', serif; font-size: 1.15rem; color: var(--white); text-decoration: none; }
    .logo span { color: var(--teal); }
    .nav-right { display: flex; gap: 1.25rem; align-items: center; }
    .nav-link { font-size: .82rem; color: var(--muted); text-decoration: none; transition: color .2s; background: none; border: none; cursor: pointer; }
    .nav-link:hover { color: var(--white); }
    .nav-api-btn { display: flex; align-items: center; gap: .4rem; font-size: .78rem; font-weight: 500; padding: .42rem .9rem; border: 1px solid var(--border); border-radius: 100px; background: var(--surface); color: var(--muted); cursor: pointer; transition: all .2s; }
    .nav-api-btn:hover { border-color: var(--teal); color: var(--teal); }
    .nav-api-btn.connected { border-color: rgba(62,207,178,.4); color: var(--teal); background: rgba(62,207,178,.07); }
    .api-dot { width: 6px; height: 6px; border-radius: 50%; background: var(--muted); transition: background .3s; }
    .nav-api-btn.connected .api-dot { background: var(--teal); box-shadow: 0 0 6px var(--teal); }

    /* ‚îÄ‚îÄ API KEY MODAL ‚îÄ‚îÄ */
    .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,.75); backdrop-filter: blur(8px); z-index: 500; display: flex; align-items: center; justify-content: center; padding: 1.5rem; opacity: 0; pointer-events: none; transition: opacity .3s; }
    .modal-overlay.open { opacity: 1; pointer-events: all; }
    .modal { background: #141414; border: 1px solid rgba(255,255,255,.1); border-radius: 16px; padding: 2.5rem; max-width: 480px; width: 100%; transform: translateY(16px); transition: transform .3s; }
    .modal-overlay.open .modal { transform: translateY(0); }
    .modal-title { font-family: 'DM Serif Display', serif; font-size: 1.5rem; color: var(--white); margin-bottom: .35rem; }
    .modal-sub { font-size: .85rem; color: var(--muted); margin-bottom: 1.75rem; line-height: 1.6; }
    .modal-sub a { color: var(--teal); text-decoration: none; }
    .modal-sub a:hover { text-decoration: underline; }
    .modal-label { font-size: .68rem; font-weight: 500; letter-spacing: .12em; text-transform: uppercase; color: var(--teal); display: block; margin-bottom: .45rem; }
    .modal-input { width: 100%; background: var(--deep); border: 1px solid var(--border); border-radius: 8px; padding: .85rem 1rem; font-family: 'Instrument Sans', sans-serif; font-size: .9rem; color: var(--white); outline: none; margin-bottom: 1.25rem; transition: border-color .2s; letter-spacing: .04em; }
    .modal-input::placeholder { color: rgba(244,240,234,.2); }
    .modal-input:focus { border-color: var(--teal); }
    .modal-note { font-size: .75rem; color: var(--muted); background: rgba(255,200,0,.05); border: 1px solid rgba(255,200,0,.15); border-radius: 6px; padding: .75rem 1rem; margin-bottom: 1.5rem; line-height: 1.6; }
    .modal-note strong { color: rgba(255,220,80,.85); font-weight: 500; }
    .modal-actions { display: flex; gap: .75rem; justify-content: flex-end; }
    .modal-cancel { font-size: .85rem; font-weight: 500; padding: .65rem 1.25rem; background: none; border: 1px solid var(--border); border-radius: 8px; color: var(--muted); cursor: pointer; transition: all .2s; }
    .modal-cancel:hover { border-color: var(--bh); color: var(--white); }
    .modal-save { font-size: .85rem; font-weight: 600; padding: .65rem 1.5rem; background: var(--teal); border: none; border-radius: 8px; color: var(--black); cursor: pointer; transition: background .2s; }
    .modal-save:hover { background: #5de0c8; }

    /* ‚îÄ‚îÄ HERO ‚îÄ‚îÄ */
    .hero { text-align: center; padding: 5.5rem 1.5rem 4.5rem; position: relative; overflow: hidden; }
    .hero-glow { position: absolute; width: 600px; height: 600px; border-radius: 50%; background: radial-gradient(ellipse, rgba(62,207,178,.065) 0%, transparent 68%); top: 50%; left: 50%; transform: translate(-50%,-50%); pointer-events: none; }
    .hero-eyebrow { display: inline-flex; align-items: center; gap: .5rem; font-size: .7rem; font-weight: 500; letter-spacing: .15em; text-transform: uppercase; color: var(--teal); margin-bottom: 1.5rem; animation: fadeUp .7s ease both; }
    .hero-eyebrow::before, .hero-eyebrow::after { content: ''; display: block; width: 22px; height: 1px; background: var(--teal); }
    .hero h1 { font-family: 'Playfair Display', serif; font-size: clamp(2.6rem, 7vw, 6rem); font-style: italic; font-weight: 900; line-height: .95; letter-spacing: -.02em; color: var(--white); margin-bottom: 1.5rem; animation: fadeUp .7s .1s ease both; }
    .hero h1 .accent { color: var(--teal); }
    .hero-sub { font-size: 1rem; color: var(--muted); max-width: 420px; margin: 0 auto 2.25rem; line-height: 1.7; animation: fadeUp .7s .2s ease both; }
    .hero-sub strong { color: var(--white); font-weight: 500; }
    .hero-rating { display: flex; align-items: center; gap: .85rem; justify-content: center; flex-wrap: wrap; font-size: .82rem; color: var(--muted); animation: fadeUp .7s .3s ease both; }
    .hero-rating strong { color: var(--white); }
    .stars { color: #00b67a; letter-spacing: .05em; }
    .rsep { width: 1px; height: 14px; background: var(--bh); }

    /* ‚îÄ‚îÄ WIZARD ‚îÄ‚îÄ */
    .wizard-wrap { max-width: 840px; margin: 0 auto; padding: 0 1.5rem 8rem; }

    /* ‚îÄ‚îÄ PROGRESS ‚îÄ‚îÄ */
    .progress-bar { display: flex; align-items: flex-start; margin-bottom: 3.5rem; }
    .pb-step { display: flex; flex-direction: column; align-items: center; flex: 1; position: relative; }
    .pb-step::before { content: ''; position: absolute; top: 15px; left: 50%; right: -50%; height: 2px; background: var(--border); z-index: 0; }
    .pb-step:last-child::before { display: none; }
    .pb-dot { width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: .72rem; font-weight: 600; background: var(--surface); border: 2px solid var(--border); color: var(--muted); position: relative; z-index: 1; transition: all .35s; }
    .pb-step.done .pb-dot { background: var(--teal); border-color: var(--teal); color: var(--black); }
    .pb-step.done .pb-dot span { display: none; }
    .pb-step.done .pb-dot::after { content: '‚úì'; font-size: .72rem; }
    .pb-step.active .pb-dot { background: var(--teal); border-color: var(--teal); color: var(--black); box-shadow: 0 0 0 4px rgba(62,207,178,.2); }
    .pb-fill { position: absolute; top: 15px; left: 50%; right: -50%; height: 2px; background: var(--teal); z-index: 0; transform-origin: left; transform: scaleX(0); transition: transform .45s ease; }
    .pb-step.done .pb-fill { transform: scaleX(1); }
    .pb-label { font-size: .63rem; font-weight: 500; letter-spacing: .06em; text-transform: uppercase; color: var(--muted); margin-top: .5rem; text-align: center; white-space: nowrap; transition: color .3s; }
    .pb-step.active .pb-label, .pb-step.done .pb-label { color: var(--teal); }

    /* ‚îÄ‚îÄ STEP PANELS ‚îÄ‚îÄ */
    .step-panel { display: none; animation: fadeUp .4s ease both; }
    .step-panel.active { display: block; }
    .step-heading { font-family: 'Playfair Display', serif; font-size: clamp(1.7rem, 3.5vw, 2.5rem); font-style: italic; font-weight: 900; color: var(--white); margin-bottom: .45rem; text-align: center; }
    .step-heading .accent { color: var(--teal); }
    .step-desc { font-size: .92rem; color: var(--muted); text-align: center; margin-bottom: 2.5rem; line-height: 1.65; }

    /* STEP 1 ‚Äî CATEGORY */
    .cat-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: .85rem; }
    .cat-card { background: var(--card); border: 1.5px solid var(--border); border-radius: 14px; padding: 1.6rem 1.2rem; cursor: pointer; transition: border-color .25s, background .25s, transform .25s; text-align: center; display: flex; flex-direction: column; gap: .55rem; align-items: center; }
    .cat-card:hover { border-color: var(--bh); background: #1a1a1a; transform: translateY(-3px); }
    .cat-card.selected { border-color: var(--teal); background: rgba(62,207,178,.07); box-shadow: 0 0 0 1px var(--teal); }
    .cat-icon { font-size: 2rem; line-height: 1; }
    .cat-title { font-family: 'DM Serif Display', serif; font-size: 1rem; color: var(--white); }
    .cat-desc { font-size: .78rem; color: var(--muted); line-height: 1.5; }

    /* STEP 2 ‚Äî UPLOAD */
    .upload-zone { border: 2px dashed rgba(62,207,178,.3); border-radius: 16px; background: rgba(62,207,178,.025); padding: 3.5rem 2rem; text-align: center; cursor: pointer; position: relative; transition: border-color .25s, background .25s; }
    .upload-zone:hover, .upload-zone.drag-over { border-color: var(--teal); background: rgba(62,207,178,.065); }
    .upload-zone input[type=file] { position: absolute; inset: 0; opacity: 0; cursor: pointer; width: 100%; height: 100%; }
    .upload-icon { font-size: 2.8rem; margin-bottom: .85rem; opacity: .7; }
    .upload-zone h3 { font-family: 'DM Serif Display', serif; font-size: 1.35rem; color: var(--white); margin-bottom: .4rem; }
    .upload-zone p { font-size: .88rem; color: var(--muted); margin-bottom: .3rem; }
    .upload-zone small { font-size: .7rem; color: rgba(244,240,234,.28); letter-spacing: .08em; text-transform: uppercase; }
    .upload-tips { display: flex; gap: .75rem; justify-content: center; flex-wrap: wrap; margin-top: 1.75rem; }
    .upload-tip { display: flex; align-items: center; gap: .35rem; font-size: .78rem; color: var(--muted); background: var(--surface); border: 1px solid var(--border); border-radius: 100px; padding: .3rem .8rem; }
    .upload-tip::before { content: '‚úì'; color: var(--teal); font-size: .68rem; }

    /* STEP 3 ‚Äî GENERATING */
    .gen-wrap { text-align: center; padding: 2.5rem 0; }
    .gen-spinner { width: 72px; height: 72px; border-radius: 50%; border: 3px solid rgba(62,207,178,.15); border-top-color: var(--teal); animation: spin 1s linear infinite; margin: 0 auto 2rem; }
    @keyframes spin { to { transform: rotate(360deg); } }
    .gen-title { font-family: 'DM Serif Display', serif; font-size: 1.5rem; color: var(--white); margin-bottom: .6rem; }
    .gen-status { font-size: .88rem; color: var(--teal); margin-bottom: 2rem; min-height: 1.4em; }
    .gen-steps { display: flex; flex-direction: column; gap: .6rem; max-width: 340px; margin: 0 auto; }
    .gen-step { display: flex; align-items: center; gap: .75rem; padding: .6rem 1rem; border-radius: 8px; background: var(--surface); border: 1px solid var(--border); font-size: .84rem; color: var(--muted); text-align: left; transition: all .3s; }
    .gen-step.active { border-color: rgba(62,207,178,.35); color: var(--white); background: rgba(62,207,178,.06); }
    .gen-step.done { border-color: rgba(62,207,178,.2); color: rgba(244,240,234,.5); }
    .gen-step-ico { font-size: 1rem; flex-shrink: 0; }
    .gen-step.active .gen-step-ico { animation: pulse 1.2s ease infinite; }
    @keyframes pulse { 0%,100% { opacity: 1; } 50% { opacity: .4; } }
    .gen-step-check { font-size: .75rem; color: var(--teal); margin-left: auto; flex-shrink: 0; }
    /* error state */
    .gen-error { display: none; background: rgba(224,85,85,.08); border: 1px solid rgba(224,85,85,.25); border-radius: 10px; padding: 1.5rem; margin-top: 1.5rem; text-align: left; }
    .gen-error.visible { display: block; }
    .gen-error-title { font-size: .82rem; font-weight: 600; color: var(--red); margin-bottom: .5rem; }
    .gen-error-msg { font-size: .82rem; color: rgba(244,240,234,.6); line-height: 1.6; }
    .gen-error-actions { display: flex; gap: .75rem; margin-top: 1rem; flex-wrap: wrap; }
    .gen-retry-btn { font-size: .82rem; font-weight: 600; padding: .55rem 1.25rem; background: var(--red); color: white; border: none; border-radius: 6px; cursor: pointer; transition: opacity .2s; }
    .gen-retry-btn:hover { opacity: .85; }
    .gen-skip-btn { font-size: .82rem; font-weight: 500; padding: .55rem 1.25rem; background: none; border: 1px solid var(--border); border-radius: 6px; color: var(--muted); cursor: pointer; transition: all .2s; }
    .gen-skip-btn:hover { border-color: var(--bh); color: var(--white); }

    /* STEP 4 ‚Äî PREVIEW */
    .preview-wrap { display: flex; flex-direction: column; align-items: center; gap: 1.75rem; }
    .preview-frame { position: relative; display: inline-block; border-radius: 12px; overflow: hidden; box-shadow: 0 0 0 1px var(--border), 0 24px 60px rgba(0,0,0,.6); max-width: 400px; width: 100%; }
    .preview-frame canvas, .preview-frame img { display: block; width: 100%; height: auto; border-radius: 12px; }
    .preview-badge { position: absolute; bottom: .85rem; left: 50%; transform: translateX(-50%); background: rgba(0,0,0,.72); backdrop-filter: blur(8px); border: 1px solid rgba(62,207,178,.3); border-radius: 100px; padding: .35rem 1rem; font-size: .68rem; font-weight: 600; letter-spacing: .1em; text-transform: uppercase; color: var(--teal); white-space: nowrap; }
    .preview-info { background: var(--surface); border: 1px solid var(--border); border-radius: 12px; padding: 1.4rem; width: 100%; max-width: 400px; }
    .preview-info-title { font-size: .65rem; font-weight: 500; letter-spacing: .12em; text-transform: uppercase; color: var(--teal); margin-bottom: .9rem; }
    .preview-row { display: flex; justify-content: space-between; font-size: .86rem; padding: .5rem 0; border-bottom: 1px solid var(--border); color: var(--muted); }
    .preview-row:last-child { border-bottom: none; }
    .preview-row span:last-child { color: var(--white); font-weight: 500; }

    /* STEP 5 ‚Äî PACKAGES */
    .pkg-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; align-items: start; }
    .pkg-card { background: var(--card); border: 1.5px solid var(--border); border-radius: 14px; padding: 1.85rem 1.4rem; cursor: pointer; transition: border-color .25s, background .25s, transform .25s; display: flex; flex-direction: column; position: relative; }
    .pkg-card:hover { border-color: var(--bh); transform: translateY(-3px); }
    .pkg-card.selected { border-color: var(--teal); background: rgba(62,207,178,.055); box-shadow: 0 0 0 1px var(--teal); }
    .pkg-badge-pop { position: absolute; top: -13px; left: 50%; transform: translateX(-50%); background: var(--teal); color: var(--black); font-size: .6rem; font-weight: 700; letter-spacing: .1em; text-transform: uppercase; padding: .28rem .8rem; border-radius: 100px; white-space: nowrap; }
    .pkg-badge-val { position: absolute; top: -13px; left: 50%; transform: translateX(-50%); background: var(--black); color: var(--white); font-size: .6rem; font-weight: 700; letter-spacing: .1em; text-transform: uppercase; padding: .26rem .8rem; border-radius: 100px; border: 1.5px solid rgba(255,255,255,.28); white-space: nowrap; }
    .pkg-incl { display: flex; justify-content: center; margin-bottom: 1rem; }
    .pkg-incl span { font-size: .66rem; font-weight: 500; padding: .2rem .65rem; border-radius: 100px; background: rgba(62,207,178,.14); color: var(--teal); }
    .pkg-name { font-family: 'DM Serif Display', serif; font-size: 1.4rem; color: var(--white); text-align: center; margin-bottom: .8rem; }
    .pkg-price { font-size: 3.2rem; font-weight: 800; line-height: 1; color: var(--white); text-align: center; margin-bottom: .3rem; }
    .pkg-price sup { font-size: 1.4rem; vertical-align: super; font-weight: 700; }
    .pkg-count { font-size: .82rem; color: var(--muted); text-align: center; margin-bottom: 1.4rem; }
    .pkg-feats { list-style: none; display: flex; flex-direction: column; gap: .55rem; margin-bottom: 1.5rem; flex: 1; }
    .pkg-feats li { font-size: .8rem; color: rgba(244,240,234,.7); display: flex; align-items: flex-start; gap: .5rem; line-height: 1.4; }
    .pkg-feats li::before { content: '‚úì'; color: var(--teal); font-size: .7rem; flex-shrink: 0; margin-top: .15rem; font-weight: 700; }
    .pkg-sel-btn { display: block; width: 100%; padding: .85rem; border-radius: 8px; font-size: .86rem; font-weight: 600; background: var(--white); color: var(--black); border: none; cursor: pointer; text-align: center; transition: background .2s, transform .2s; }
    .pkg-card.selected .pkg-sel-btn { background: var(--teal); }
    .pkg-sel-btn:hover { background: var(--teal); }

    /* STEP 6 ‚Äî CHECKOUT */
    .checkout-wrap { max-width: 500px; margin: 0 auto; }
    .order-summary { background: var(--card); border: 1px solid var(--border); border-radius: 14px; overflow: hidden; margin-bottom: 1.4rem; }
    .os-header { background: var(--surface); padding: 1.1rem 1.5rem; font-size: .68rem; font-weight: 500; letter-spacing: .12em; text-transform: uppercase; color: var(--teal); border-bottom: 1px solid var(--border); }
    .os-body { padding: 1.4rem 1.5rem; display: flex; flex-direction: column; gap: .9rem; }
    .os-row { display: flex; justify-content: space-between; align-items: flex-start; font-size: .88rem; }
    .os-label { color: var(--muted); flex-shrink: 0; }
    .os-val { color: var(--white); font-weight: 500; text-align: right; max-width: 58%; }
    .os-thumb { width: 52px; height: 52px; border-radius: 8px; object-fit: cover; border: 1px solid var(--border); flex-shrink: 0; }
    .os-divider { border: none; border-top: 1px solid var(--border); }
    .os-total { display: flex; justify-content: space-between; align-items: center; font-size: 1rem; font-weight: 600; }
    .os-total .os-price { font-size: 1.55rem; font-weight: 800; color: var(--teal); }
    .pay-methods { display: flex; align-items: center; gap: .45rem; flex-wrap: wrap; margin-bottom: .9rem; }
    .pay-chip { font-size: .66rem; font-weight: 600; padding: .25rem .6rem; background: var(--surface); border: 1px solid var(--border); border-radius: 4px; color: var(--muted); letter-spacing: .04em; }
    .pay-secure { display: flex; align-items: center; gap: .35rem; font-size: .73rem; color: var(--muted); margin-left: auto; }
    .pay-note { font-size: .8rem; color: var(--muted); line-height: 1.65; background: var(--surface); border: 1px solid var(--border); border-radius: 8px; padding: .95rem 1.15rem; margin-bottom: 1.4rem; }
    .pay-note strong { color: var(--white); font-weight: 500; }
    .pay-btn { width: 100%; padding: 1.05rem; font-family: 'Instrument Sans', sans-serif; font-size: .98rem; font-weight: 700; background: var(--teal); color: var(--black); border: none; border-radius: 10px; cursor: pointer; transition: background .2s, transform .2s, box-shadow .2s; }
    .pay-btn:hover { background: #5de0c8; transform: translateY(-2px); box-shadow: 0 8px 28px rgba(62,207,178,.25); }

    /* NAV BUTTONS */
    .step-nav { display: flex; align-items: center; justify-content: space-between; margin-top: 2.25rem; gap: 1rem; }
    .btn-back { display: flex; align-items: center; gap: .45rem; font-size: .84rem; font-weight: 500; color: var(--muted); background: none; border: 1px solid var(--border); border-radius: 8px; padding: .65rem 1.2rem; cursor: pointer; transition: color .2s, border-color .2s; }
    .btn-back:hover { color: var(--white); border-color: var(--bh); }
    .btn-next { display: flex; align-items: center; gap: .45rem; font-size: .88rem; font-weight: 600; color: var(--black); background: var(--teal); border: none; border-radius: 8px; padding: .75rem 1.9rem; cursor: pointer; transition: background .2s, transform .2s, box-shadow .2s; margin-left: auto; }
    .btn-next:hover { background: #5de0c8; transform: translateY(-2px); box-shadow: 0 6px 22px rgba(62,207,178,.22); }
    .btn-next:disabled { opacity: .38; cursor: not-allowed; transform: none !important; box-shadow: none !important; }

    /* SECTIONS */
    .info-section { padding: 5rem 1.5rem; }
    .info-inner { max-width: 960px; margin: 0 auto; }
    .stag { display: inline-flex; align-items: center; gap: .4rem; font-size: .68rem; font-weight: 500; letter-spacing: .12em; text-transform: uppercase; color: var(--teal); margin-bottom: 1rem; }
    .stag::before { content: ''; display: block; width: 18px; height: 1px; background: var(--teal); }
    .sh { font-family: 'Playfair Display', serif; font-size: clamp(1.8rem, 3.5vw, 2.9rem); font-style: italic; font-weight: 900; line-height: 1.1; color: var(--white); margin-bottom: .85rem; }
    .ssub { font-size: .92rem; color: var(--muted); max-width: 460px; line-height: 1.7; }
    .how-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.15rem; margin-top: 2.75rem; }
    .how-card { background: var(--surface); border: 1px solid var(--border); border-radius: 12px; padding: 1.6rem; transition: border-color .3s; }
    .how-card:hover { border-color: var(--bh); }
    .how-num { font-family: 'Playfair Display', serif; font-size: 2.2rem; font-style: italic; font-weight: 900; color: rgba(62,207,178,.12); line-height: 1; margin-bottom: .75rem; }
    .how-ico { font-size: 1.3rem; margin-bottom: .6rem; }
    .how-title { font-family: 'DM Serif Display', serif; font-size: 1rem; color: var(--white); margin-bottom: .35rem; }
    .how-desc { font-size: .83rem; color: var(--muted); line-height: 1.6; }
    .rev-strip { background: var(--deep); border-top: 1px solid var(--border); border-bottom: 1px solid var(--border); padding: 5rem 1.5rem; }
    .rev-inner { max-width: 960px; margin: 0 auto; }
    .rev-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-top: 2.75rem; }
    .rv { background: var(--surface); border: 1px solid var(--border); border-radius: 12px; padding: 1.4rem; transition: border-color .3s; }
    .rv:hover { border-color: var(--bh); }
    .rv-stars { color: #00b67a; font-size: .8rem; margin-bottom: .8rem; letter-spacing: .1em; }
    .rv-text { font-size: .88rem; color: rgba(244,240,234,.78); font-style: italic; line-height: 1.7; margin-bottom: 1rem; }
    .rv-author { font-size: .73rem; color: var(--muted); display: flex; align-items: center; gap: .5rem; }
    .rv-av { width: 26px; height: 26px; border-radius: 50%; background: rgba(62,207,178,.14); border: 1px solid rgba(62,207,178,.3); display: flex; align-items: center; justify-content: center; font-size: .72rem; color: var(--teal); font-weight: 600; }
    .faq-list { margin-top: 2.5rem; }
    .fi { border-bottom: 1px solid var(--border); }
    .fq { width: 100%; background: none; border: none; text-align: left; padding: 1.2rem 0; font-family: 'DM Serif Display', serif; font-size: 1rem; color: var(--white); cursor: pointer; display: flex; justify-content: space-between; align-items: center; gap: 1rem; }
    .fq::after { content: '+'; font-size: 1.25rem; color: var(--teal); flex-shrink: 0; font-weight: 300; transition: transform .3s; }
    .fi.open .fq::after { transform: rotate(45deg); }
    .fa { max-height: 0; overflow: hidden; transition: max-height .4s ease; }
    .fa p { padding-bottom: 1.2rem; font-size: .87rem; color: var(--muted); line-height: 1.75; }
    footer { background: #050505; border-top: 1px solid var(--border); padding: 2.5rem 2rem; }
    .footer-inner { max-width: 960px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1.25rem; }
    .footer-logo { font-family: 'DM Serif Display', serif; font-size: 1.05rem; }
    .footer-logo span { color: var(--teal); }
    .footer-links { display: flex; gap: 1.25rem; flex-wrap: wrap; }
    .footer-links a { font-size: .8rem; color: var(--muted); text-decoration: none; transition: color .2s; }
    .footer-links a:hover { color: var(--teal); }
    .footer-copy { font-size: .73rem; color: rgba(244,240,234,.22); text-align: center; padding-top: 1.25rem; border-top: 1px solid var(--border); max-width: 960px; margin: 1.25rem auto 0; }

    .reveal { opacity: 0; transform: translateY(20px); transition: opacity .6s ease, transform .6s ease; }
    .reveal.visible { opacity: 1; transform: none; }
    @keyframes fadeUp { from { opacity: 0; transform: translateY(24px); } to { opacity: 1; transform: translateY(0); } }

    @media (max-width: 680px) {
      .cat-grid { grid-template-columns: repeat(2, 1fr); }
      .pkg-grid { grid-template-columns: 1fr; max-width: 360px; margin: 0 auto; }
      .pb-label { display: none; }
      .hero h1 { font-size: 2.5rem; }
      nav { padding: .85rem 1.1rem; }
      .wizard-wrap { padding: 0 1rem 6rem; }
    }
  </style>
</head>
<body>

<!-- API KEY MODAL -->
<!-- NAV -->
<nav>
  <a class="logo" href="#">Pawtraits<span>.</span></a>
  <div class="nav-right">
    <a class="nav-link" href="#how-it-works">How It Works</a>
    <a class="nav-link" href="#faq">FAQ</a>
    <div class="nav-api-btn connected" style="cursor:default;">
      <span class="api-dot" style="background:var(--teal);box-shadow:0 0 6px var(--teal);"></span>
      <span>Grok AI Active</span>
    </div>
  </div>
</nav>

<!-- HERO -->
<section class="hero">
  <div class="hero-glow"></div>
  <div class="hero-eyebrow">Powered by Grok AI</div>
  <h1>Upload. Generate.<br><span class="accent">Immortalise.</span></h1>
  <p class="hero-sub">Upload your photo ‚Äî our AI paints it as a Renaissance masterpiece. <strong>Printed on archival canvas and shipped to your door.</strong></p>
  <div class="hero-rating">
    <div class="stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
    <strong>4.9 / 5</strong>
    <div class="rsep"></div>
    <span>2,400+ portraits delivered</span>
    <div class="rsep"></div>
    <span>Ships worldwide</span>
  </div>
</section>

<!-- WIZARD -->
<div class="wizard-wrap">

  <!-- Progress bar -->
  <div class="progress-bar" id="progress-bar">
    <div class="pb-step active" data-step="1"><div class="pb-dot"><span>1</span></div><div class="pb-fill"></div><div class="pb-label">Subject</div></div>
    <div class="pb-step" data-step="2"><div class="pb-dot"><span>2</span></div><div class="pb-fill"></div><div class="pb-label">Upload</div></div>
    <div class="pb-step" data-step="3"><div class="pb-dot"><span>3</span></div><div class="pb-fill"></div><div class="pb-label">Generating</div></div>
    <div class="pb-step" data-step="4"><div class="pb-dot"><span>4</span></div><div class="pb-fill"></div><div class="pb-label">Preview</div></div>
    <div class="pb-step" data-step="5"><div class="pb-dot"><span>5</span></div><div class="pb-fill"></div><div class="pb-label">Package</div></div>
    <div class="pb-step" data-step="6"><div class="pb-dot"><span>6</span></div><div class="pb-fill"></div><div class="pb-label">Checkout</div></div>
  </div>

  <!-- ‚îÄ‚îÄ STEP 1: CATEGORY ‚îÄ‚îÄ -->
  <div class="step-panel active" id="step-1">
    <h2 class="step-heading">What would you like to <span class="accent">immortalise?</span></h2>
    <p class="step-desc">Choose your portrait category ‚Äî our AI will style it accordingly.</p>
    <div class="cat-grid">
      <div class="cat-card" data-cat="pets" onclick="selectCat(this)"><div class="cat-icon">üêæ</div><div class="cat-title">Pets</div><div class="cat-desc">Dogs, cats, rabbits, birds ‚Äî any beloved companion</div></div>
      <div class="cat-card" data-cat="family" onclick="selectCat(this)"><div class="cat-icon">üë®‚Äçüë©‚Äçüëß</div><div class="cat-title">Family</div><div class="cat-desc">The whole household in one masterpiece</div></div>
      <div class="cat-card" data-cat="children" onclick="selectCat(this)"><div class="cat-icon">üßí</div><div class="cat-title">Children</div><div class="cat-desc">Crown your little one for the ages</div></div>
      <div class="cat-card" data-cat="couples" onclick="selectCat(this)"><div class="cat-icon">üíë</div><div class="cat-title">Couples</div><div class="cat-desc">Weddings, anniversaries, or simply love</div></div>
      <div class="cat-card" data-cat="self" onclick="selectCat(this)"><div class="cat-icon">ü™û</div><div class="cat-title">Self-Portrait</div><div class="cat-desc">You, rendered as a 17th-century noble</div></div>
    </div>
    <div class="step-nav">
      <div></div>
      <button class="btn-next" id="btn-next-1" disabled onclick="goToStep(2)">Continue &nbsp;‚Üí</button>
    </div>
  </div>

  <!-- ‚îÄ‚îÄ STEP 2: UPLOAD ‚îÄ‚îÄ -->
  <div class="step-panel" id="step-2">
    <h2 class="step-heading">Upload your <span class="accent">photo</span></h2>
    <p class="step-desc">Share a clear, well-lit photo. The face should be visible and in focus.</p>
    <div class="upload-zone" id="upload-zone">
      <input type="file" id="photo-input" accept="image/*" onchange="handleFile(this.files[0])">
      <div class="upload-icon">üì∏</div>
      <h3>Drop your photo here</h3>
      <p>or click anywhere to browse</p>
      <small>JPG ¬∑ PNG ¬∑ HEIC &nbsp;¬∑&nbsp; Max 20 MB</small>
    </div>
    <div class="upload-tips">
      <div class="upload-tip">Face clearly visible</div>
      <div class="upload-tip">Good natural lighting</div>
      <div class="upload-tip">Sharp focus</div>
      <div class="upload-tip">Front-facing works best</div>
    </div>
    <div class="step-nav">
      <button class="btn-back" onclick="goToStep(1)">‚Üê Back</button>
      <button class="btn-next" id="btn-next-2" disabled onclick="startGeneration()">Generate Portrait &nbsp;‚Üí</button>
    </div>
  </div>

  <!-- ‚îÄ‚îÄ STEP 3: GENERATING ‚îÄ‚îÄ -->
  <div class="step-panel" id="step-3">
    <h2 class="step-heading">Creating your <span class="accent">masterpiece</span></h2>
    <p class="step-desc">Grok AI is painting your Renaissance portrait. This takes about 20‚Äì30 seconds.</p>
    <div class="gen-wrap">
      <div class="gen-spinner" id="gen-spinner"></div>
      <div class="gen-title" id="gen-title">Analysing your photo‚Ä¶</div>
      <div class="gen-status" id="gen-status">Studying your subject with Grok Vision</div>
      <div class="gen-steps">
        <div class="gen-step active" id="gstep-1">
          <span class="gen-step-ico">üîç</span>
          <span>Analysing subject with Grok Vision</span>
          <span class="gen-step-check" id="gcheck-1" style="display:none">‚úì</span>
        </div>
        <div class="gen-step" id="gstep-2">
          <span class="gen-step-ico">üé®</span>
          <span>Crafting Renaissance portrait prompt</span>
          <span class="gen-step-check" id="gcheck-2" style="display:none">‚úì</span>
        </div>
        <div class="gen-step" id="gstep-3">
          <span class="gen-step-ico">üñºÔ∏è</span>
          <span>Generating masterpiece with Grok Imagine</span>
          <span class="gen-step-check" id="gcheck-3" style="display:none">‚úì</span>
        </div>
        <div class="gen-step" id="gstep-4">
          <span class="gen-step-ico">‚ú®</span>
          <span>Applying finishing touches</span>
          <span class="gen-step-check" id="gcheck-4" style="display:none">‚úì</span>
        </div>
      </div>
      <div class="gen-error" id="gen-error">
        <div class="gen-error-title" id="gen-error-title">Generation failed</div>
        <div class="gen-error-msg" id="gen-error-msg">An error occurred while generating your portrait.</div>
        <div class="gen-error-actions">
          <button class="gen-retry-btn" onclick="startGeneration()">Retry</button>
          <button class="gen-skip-btn" onclick="showFallbackPreview()">Continue with preview photo</button>
        </div>
      </div>
    </div>
  </div>

  <!-- ‚îÄ‚îÄ STEP 4: PREVIEW ‚îÄ‚îÄ -->
  <div class="step-panel" id="step-4">
    <h2 class="step-heading">Your AI <span class="accent">portrait</span></h2>
    <p class="step-desc">Your masterpiece is ready. Select a package to receive your full-resolution, watermark-free print.</p>
    <div class="preview-wrap">
      <div class="preview-frame">
        <canvas id="preview-canvas"></canvas>
        <div class="preview-badge">‚ú¶ &nbsp; Watermarked Preview</div>
      </div>
      <div class="preview-info">
        <div class="preview-info-title">Your commission details</div>
        <div class="preview-row"><span>Category</span><span id="prev-cat">‚Äî</span></div>
        <div class="preview-row"><span>Style</span><span>Old Masters Renaissance</span></div>
        <div class="preview-row"><span>Generated by</span><span style="color:var(--teal)">Grok AI ‚ú¶</span></div>
        <div class="preview-row"><span>Status</span><span style="color:var(--teal)">‚úì Portrait ready</span></div>
      </div>
    </div>
    <div class="step-nav">
      <button class="btn-back" onclick="goToStep(2)">‚Üê Retake photo</button>
      <button class="btn-next" onclick="goToStep(5)">Choose Package &nbsp;‚Üí</button>
    </div>
  </div>

  <!-- ‚îÄ‚îÄ STEP 5: PACKAGES ‚îÄ‚îÄ -->
  <div class="step-panel" id="step-5">
    <h2 class="step-heading">Choose your <span class="accent">package</span></h2>
    <p class="step-desc">All packages include a digital preview before printing and your high-resolution digital file.</p>
    <div class="pkg-grid">
      <div class="pkg-card" data-pkg="squire" data-price="$49" data-url="https://buy.stripe.com/7sYeVeb6Z5io2ov1GN4wM07" onclick="selectPkg(this)">
        <div class="pkg-badge-pop">POPULAR</div>
        <div class="pkg-incl"><span>Includes Downloads</span></div>
        <div class="pkg-name">Squire Pack</div>
        <div class="pkg-price"><sup>$</sup>49</div>
        <div class="pkg-count">1 portrait</div>
        <ul class="pkg-feats">
          <li>8√ó10 archival canvas print</li>
          <li>Unframed, ready to hang</li>
          <li>300 DPI digital file</li>
          <li>1 revision included</li>
          <li>Ships in 7‚Äì10 days</li>
          <li>Commercial use rights</li>
        </ul>
        <button class="pkg-sel-btn">Select Squire</button>
      </div>
      <div class="pkg-card" data-pkg="noble" data-price="$89" data-url="https://buy.stripe.com/5kQbJ2df7eSYfbhfxD4wM06" onclick="selectPkg(this)">
        <div class="pkg-incl"><span>Includes Downloads</span></div>
        <div class="pkg-name">Noble Pack</div>
        <div class="pkg-price"><sup>$</sup>89</div>
        <div class="pkg-count">1 framed portrait</div>
        <ul class="pkg-feats">
          <li>12√ó16 archival canvas print</li>
          <li>Ornate gold resin frame</li>
          <li>300 DPI digital file</li>
          <li>Priority processing</li>
          <li>2 revisions included</li>
          <li>Ships in 7‚Äì10 days</li>
          <li>Commercial use rights</li>
        </ul>
        <button class="pkg-sel-btn">Select Noble</button>
      </div>
      <div class="pkg-card" data-pkg="royal" data-price="$149" data-url="https://buy.stripe.com/8x24gA8YRdOUgfldpv4wM08" onclick="selectPkg(this)">
        <div class="pkg-badge-val">BEST VALUE</div>
        <div class="pkg-incl"><span>Includes Downloads</span></div>
        <div class="pkg-name">Royal Pack</div>
        <div class="pkg-price"><sup>$</sup>149</div>
        <div class="pkg-count">1 large framed portrait</div>
        <ul class="pkg-feats">
          <li>18√ó24 archival canvas print</li>
          <li>Handcrafted walnut frame</li>
          <li>300 DPI digital file</li>
          <li>Up to 3 subjects</li>
          <li>Unlimited revisions</li>
          <li>Express 5‚Äì7 day shipping</li>
          <li>Commercial use rights</li>
        </ul>
        <button class="pkg-sel-btn">Select Royal</button>
      </div>
    </div>
    <div class="step-nav">
      <button class="btn-back" onclick="goToStep(4)">‚Üê Back</button>
      <button class="btn-next" id="btn-next-5" disabled onclick="goToStep(6)">Review Order &nbsp;‚Üí</button>
    </div>
  </div>

  <!-- ‚îÄ‚îÄ STEP 6: CHECKOUT ‚îÄ‚îÄ -->
  <div class="step-panel" id="step-6">
    <h2 class="step-heading">Review &amp; <span class="accent">pay</span></h2>
    <p class="step-desc">You'll be taken to Stripe's secure checkout. After payment, we print and ship your masterpiece.</p>
    <div class="checkout-wrap">
      <div class="order-summary">
        <div class="os-header">Order Summary</div>
        <div class="os-body">
          <div class="os-row">
            <span class="os-label">Your portrait</span>
            <img class="os-thumb" id="checkout-thumb" src="" alt="">
          </div>
          <hr class="os-divider">
          <div class="os-row"><span class="os-label">Category</span><span class="os-val" id="checkout-cat">‚Äî</span></div>
          <div class="os-row"><span class="os-label">Generated by</span><span class="os-val" style="color:var(--teal)">Grok AI ‚ú¶</span></div>
          <div class="os-row"><span class="os-label">Package</span><span class="os-val" id="checkout-pkg">‚Äî</span></div>
          <div class="os-row"><span class="os-label">Includes</span><span class="os-val" id="checkout-includes">‚Äî</span></div>
          <div class="os-row"><span class="os-label">Shipping</span><span class="os-val" id="checkout-ship">‚Äî</span></div>
          <hr class="os-divider">
          <div class="os-total"><span>Total</span><span class="os-price" id="checkout-price">‚Äî</span></div>
        </div>
      </div>
      <div class="pay-note">
        After checkout, <strong>your AI-generated portrait file is sent to us automatically.</strong> We'll print it on archival canvas per your package and ship it to you with full tracking.
      </div>
      <div class="pay-methods">
        <div class="pay-chip">VISA</div>
        <div class="pay-chip">Mastercard</div>
        <div class="pay-chip">AMEX</div>
        <div class="pay-chip">Apple Pay</div>
        <div class="pay-chip">Google Pay</div>
        <div class="pay-secure">üîí Stripe secured</div>
      </div>
      <button class="pay-btn" onclick="goToStripe()">Proceed to Secure Checkout</button>
      <div class="step-nav" style="margin-top:1rem;">
        <button class="btn-back" onclick="goToStep(5)">‚Üê Change package</button>
      </div>
    </div>
  </div>

</div><!-- /wizard-wrap -->

<!-- HOW IT WORKS -->
<div id="how-it-works" style="background:var(--deep);border-top:1px solid var(--border);">
  <div class="info-section">
    <div class="info-inner">
      <p class="stag reveal">The Process</p>
      <h2 class="sh reveal">How it works</h2>
      <div class="how-grid">
        <div class="how-card reveal"><div class="how-num">01</div><div class="how-ico">üñºÔ∏è</div><div class="how-title">Pick your subject</div><p class="how-desc">Choose from pets, family, couples, children, or a self-portrait.</p></div>
        <div class="how-card reveal"><div class="how-num">02</div><div class="how-ico">üì∏</div><div class="how-title">Upload your photo</div><p class="how-desc">A clear, well-lit photo. Grok Vision analyses your subject instantly.</p></div>
        <div class="how-card reveal"><div class="how-num">03</div><div class="how-ico">ü§ñ</div><div class="how-title">AI paints the portrait</div><p class="how-desc">Grok Imagine renders your subject in old-master style in about 20‚Äì30 seconds. You see a watermarked preview.</p></div>
        <div class="how-card reveal"><div class="how-num">04</div><div class="how-ico">üì¶</div><div class="how-title">Print &amp; delivery</div><p class="how-desc">We print your portrait on archival canvas and ship worldwide in 7‚Äì10 days.</p></div>
      </div>
    </div>
  </div>
</div>

<!-- REVIEWS -->
<div class="rev-strip" id="reviews">
  <div class="rev-inner">
    <div style="display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:1rem;">
      <div><p class="stag reveal">Social Proof</p><h2 class="sh reveal">What our patrons say</h2></div>
      <div class="reveal" style="text-align:right;"><div class="stars" style="font-size:1.15rem;">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div><div style="font-size:.78rem;color:var(--muted);margin-top:.25rem;">4.9 ¬∑ 2,400+ reviews</div></div>
    </div>
    <div class="rev-grid">
      <div class="rv reveal"><div class="rv-stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div><p class="rv-text">"I cannot stop staring at it. Max dressed in full 17th-century regalia ‚Äî it is the most magnificent thing I have ever hung in my home."</p><div class="rv-author"><div class="rv-av">S</div>Sarah K. ¬∑ London ¬∑ Pet Portrait</div></div>
      <div class="rv reveal"><div class="rv-stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div><p class="rv-text">"Ordered a couples portrait as an anniversary gift. She wept. The quality is extraordinary ‚Äî it genuinely looks like a painting from a museum."</p><div class="rv-author"><div class="rv-av">M</div>Marco D. ¬∑ Milan ¬∑ Couple Portrait</div></div>
      <div class="rv reveal"><div class="rv-stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div><p class="rv-text">"Got a children's portrait for my daughter's birthday. She asks to look at it every single morning. Worth every penny."</p><div class="rv-author"><div class="rv-av">A</div>Amelia T. ¬∑ New York ¬∑ Children's Portrait</div></div>
    </div>
  </div>
</div>

<!-- FAQ -->
<div class="info-section" id="faq">
  <div class="info-inner" style="max-width:680px;">
    <p class="stag reveal">FAQ</p>
    <h2 class="sh reveal">Common questions</h2>
    <div class="faq-list">
      <div class="fi reveal"><button class="fq">How does the AI generation work?</button><div class="fa"><p>We use two Grok AI models from xAI. First, Grok Vision analyses your uploaded photo and creates a detailed description of your subject. Then, Grok Imagine uses that description to paint a full Renaissance-style portrait in the style of the old masters ‚Äî Rembrandt, Van Dyck, Vermeer. The whole process takes about 20‚Äì30 seconds.</p></div></div>
      <div class="fi reveal"><button class="fq">Why is there a watermark on my preview?</button><div class="fa"><p>The watermark is applied to your AI-generated portrait preview so you can see the result before paying. Once you complete your purchase, we remove the watermark and print the full-resolution version on archival canvas.</p></div></div>
      <div class="fi reveal"><button class="fq">What photo should I upload?</button><div class="fa"><p>A clear, well-lit, front-facing photo works best. Natural daylight, sharp focus, and a visible face give the best AI results. You can always regenerate if you're not happy with the first result.</p></div></div>
      <div class="fi reveal"><button class="fq">Can I include multiple people or pets?</button><div class="fa"><p>Yes ‚Äî upload a photo with multiple subjects and the AI will include all of them. The Royal package supports up to 3 subjects with the best results. For single subjects, any package works perfectly.</p></div></div>
      <div class="fi reveal"><button class="fq">How long does delivery take?</button><div class="fa"><p>Standard orders ship within 7‚Äì10 business days. Royal tier ships in 5‚Äì7 days. International delivery adds 3‚Äì7 days. You'll receive full tracking once your portrait ships.</p></div></div>
      <div class="fi reveal"><button class="fq">Where do I get a Grok API key?</button><div class="fa"><p>Sign up at <a href="https://console.x.ai" target="_blank" style="color:var(--teal)">console.x.ai</a> ‚Äî you'll get free credits to start. Enter your key using the "Connect Grok AI" button in the top navigation.</p></div></div>
    </div>
  </div>
</div>

<!-- FOOTER -->
<footer>
  <div class="footer-inner">
    <div class="footer-logo">Pawtraits<span>.</span></div>
    <div class="footer-links">
      <a href="#how-it-works">How It Works</a>
      <a href="#reviews">Reviews</a>
      <a href="#faq">FAQ</a>
      <a href="/cdn-cgi/l/email-protection#a2cac7cececde2d2c3d5d6d0c3cbd6d18cc1cdcf"><span class="__cf_email__" data-cfemail="b6ded3dadad9f6c6d7c1c2c4d7dfc2c598d5d9db">[email&#160;protected]</span></a>
      <a href="#">Privacy Policy</a>
    </div>
  </div>
  <div class="footer-copy">¬© 2025 Pawtraits ¬∑ All rights reserved ¬∑ AI portraits powered by Grok (xAI) ¬∑ Payments secured by Stripe ¬∑ Ships worldwide</div>
</footer>

<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   STATE
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
const state = {
  cat: null, catLabel: null,
  file: null, imageDataURL: null, imageBase64: null,
  generatedImageData: null,
  printifyImageId:  null,
  printifyImageUrl: null,
  isFallback: false,
  pkg: null, pkgPrice: null, pkgLabel: null,
};

const catLabels = {
  pets: 'Pet Portrait', family: 'Family Portrait',
  children: "Children's Portrait", couples: 'Couple Portrait', self: 'Self-Portrait',
};

const catPromptModifiers = {
  pets:     'This is a beloved pet. Dress them in miniature royal regalia with a velvet cushion. The animal should look regal, dignified, and noble.',
  family:   'This is a family group portrait. Pose them together in aristocratic fashion with warm familial closeness.',
  children: 'This is a child. Crown them with a small gold coronet and dress them in royal robes. Cherubic, innocent, regal.',
  couples:  'This is a couple. Pose them together with a tender, aristocratic intimacy. Two nobles deeply bonded.',
  self:     'This is a solo self-portrait. Dramatic three-quarter view, piercing gaze, self-assured noble bearing.',
};

const pkgDetails = {
  squire: { includes: '8√ó10 canvas, unframed + digital file', shipping: '7‚Äì10 business days' },
  noble:  { includes: '12√ó16 canvas, gold frame + digital file', shipping: '7‚Äì10 business days' },
  royal:  { includes: '18√ó24 canvas, walnut frame + digital file', shipping: '5‚Äì7 days (express)' },
};

/* API key is server-side ‚Äî no client management needed */

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   STEP NAVIGATION
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function goToStep(n) {
  document.querySelectorAll('.step-panel').forEach(p => p.classList.remove('active'));
  document.getElementById('step-' + n).classList.add('active');
  document.querySelectorAll('.pb-step').forEach(s => {
    const sn = parseInt(s.dataset.step);
    s.classList.remove('active', 'done');
    if (sn < n) s.classList.add('done');
    else if (sn === n) s.classList.add('active');
  });
  document.querySelector('.wizard-wrap').scrollIntoView({ behavior: 'smooth', block: 'start' });
  if (n === 6) populateCheckout();
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   STEP 1 ‚Äî CATEGORY
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function selectCat(el) {
  document.querySelectorAll('.cat-card').forEach(c => c.classList.remove('selected'));
  el.classList.add('selected');
  state.cat = el.dataset.cat;
  state.catLabel = catLabels[state.cat];
  document.getElementById('btn-next-1').disabled = false;
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   STEP 2 ‚Äî UPLOAD
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function handleFile(file) {
  if (!file) return;
  if (file.size > 20 * 1024 * 1024) { alert('File too large. Please upload an image under 20 MB.'); return; }
  state.file = file;
  const reader = new FileReader();
  reader.onload = e => {
    state.imageDataURL = e.target.result;
    // Extract pure base64 (strip "data:image/xxx;base64," prefix)
    state.imageBase64 = e.target.result.split(',')[1];
    document.getElementById('btn-next-2').disabled = false;
    const zone = document.getElementById('upload-zone');
    zone.style.borderColor = 'var(--teal)';
    zone.style.background = 'rgba(62,207,178,.06)';
    zone.querySelector('h3').textContent = '‚úì  Photo ready';
    zone.querySelector('p').textContent = file.name;
  };
  reader.readAsDataURL(file);
}
const uploadZone = document.getElementById('upload-zone');
uploadZone.addEventListener('dragover', e => { e.preventDefault(); uploadZone.classList.add('drag-over'); });
uploadZone.addEventListener('dragleave', () => uploadZone.classList.remove('drag-over'));
uploadZone.addEventListener('drop', e => {
  e.preventDefault(); uploadZone.classList.remove('drag-over');
  const file = e.dataTransfer.files[0];
  if (file && file.type.startsWith('image/')) { document.getElementById('photo-input').files = e.dataTransfer.files; handleFile(file); }
});

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   STEP 3 ‚Äî AI GENERATION
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function setGenStep(n, status) {
  // Mark previous steps done
  for (let i = 1; i < n; i++) {
    document.getElementById('gstep-' + i).classList.remove('active');
    document.getElementById('gstep-' + i).classList.add('done');
    document.getElementById('gcheck-' + i).style.display = 'inline';
  }
  // Set current step active
  for (let i = 1; i <= 4; i++) {
    if (i === n) {
      document.getElementById('gstep-' + i).classList.add('active');
      document.getElementById('gstep-' + i).classList.remove('done');
      document.getElementById('gcheck-' + i).style.display = 'none';
    } else if (i > n) {
      document.getElementById('gstep-' + i).classList.remove('active', 'done');
      document.getElementById('gcheck-' + i).style.display = 'none';
    }
  }
  document.getElementById('gen-status').textContent = status;
}

function showGenError(title, msg) {
  document.getElementById('gen-spinner').style.display = 'none';
  document.getElementById('gen-title').textContent = 'Something went wrong';
  document.getElementById('gen-status').textContent = '';
  const errBox = document.getElementById('gen-error');
  document.getElementById('gen-error-title').textContent = title;
  document.getElementById('gen-error-msg').textContent = msg;
  errBox.classList.add('visible');
}

function resetGenUI() {
  document.getElementById('gen-spinner').style.display = 'block';
  document.getElementById('gen-title').textContent = 'Analysing your photo‚Ä¶';
  document.getElementById('gen-status').textContent = 'Studying your subject with Grok Vision';
  document.getElementById('gen-error').classList.remove('visible');
  for (let i = 1; i <= 4; i++) {
    const s = document.getElementById('gstep-' + i);
    s.classList.remove('active', 'done');
    document.getElementById('gcheck-' + i).style.display = 'none';
  }
  document.getElementById('gstep-1').classList.add('active');
}

async function startGeneration() {
  goToStep(3);
  resetGenUI();
  state.isFallback = false;

  try {
    // Steps 1‚Äì3 happen server-side in /api/generate
    setGenStep(1, 'Studying your subject with Grok Vision‚Ä¶');

    // Simulate step transitions while the server works
    const stepTimer2 = setTimeout(() => setGenStep(2, 'Crafting the Renaissance portrait prompt‚Ä¶'), 4000);
    const stepTimer3 = setTimeout(() => {
      setGenStep(3, 'Painting your portrait with Grok Imagine‚Ä¶');
      document.getElementById('gen-title').textContent = 'Painting your portrait‚Ä¶';
    }, 7000);

    const res = await fetch('/api/generate', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        imageBase64:   state.imageBase64,
        imageMimeType: state.file?.type || 'image/jpeg',
        category:      state.cat,
        catLabel:      state.catLabel,
      }),
    });

    clearTimeout(stepTimer2);
    clearTimeout(stepTimer3);

    if (!res.ok) {
      const err = await res.json().catch(() => ({}));
      throw new Error(err.error || `Server error ${res.status}`);
    }

    const data = await res.json();
    state.generatedImageData  = data.imageData;
    state.printifyImageId     = data.printifyImageId  || null;
    state.printifyImageUrl    = data.printifyImageUrl || null;

    /* ‚îÄ‚îÄ Step 4: Finishing touches ‚îÄ‚îÄ */
    setGenStep(4, 'Applying the finishing touches‚Ä¶');
    await delay(700);

    for (let i = 1; i <= 4; i++) {
      document.getElementById('gstep-' + i).classList.remove('active');
      document.getElementById('gstep-' + i).classList.add('done');
      document.getElementById('gcheck-' + i).style.display = 'inline';
    }
    document.getElementById('gen-status').textContent = 'Your masterpiece is ready ‚ú¶';
    document.getElementById('gen-title').textContent = 'Portrait complete!';

    await delay(800);
    renderWatermarkedPreview(state.generatedImageData);
    goToStep(4);

  } catch (err) {
    console.error('Generation error:', err);
    showGenError('Generation failed', err.message || 'An unexpected error occurred. Please try again.');
  }
}

function showFallbackPreview() {
  state.isFallback = true;
  renderWatermarkedPreview(state.imageDataURL);
  goToStep(4);
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   STEP 4 ‚Äî WATERMARKED PREVIEW
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function renderWatermarkedPreview(imageSrc) {
  const canvas = document.getElementById('preview-canvas');
  const ctx = canvas.getContext('2d');
  const img = new Image();
  img.crossOrigin = 'anonymous';
  img.onload = () => {
    const maxW = 400;
    const scale = Math.min(1, maxW / img.width);
    canvas.width  = Math.round(img.width  * scale);
    canvas.height = Math.round(img.height * scale);
    const W = canvas.width, H = canvas.height;

    // Draw image
    ctx.drawImage(img, 0, 0, W, H);

    // Slight warm darkening overlay (old masters vibe)
    ctx.fillStyle = 'rgba(10,5,0,0.12)';
    ctx.fillRect(0, 0, W, H);

    // ‚îÄ‚îÄ Diagonal tiled text watermark ‚îÄ‚îÄ
    ctx.save();
    ctx.font = 'bold 13px "Instrument Sans", Arial, sans-serif';
    ctx.fillStyle = 'rgba(255,255,255,0.18)';
    ctx.translate(W / 2, H / 2);
    ctx.rotate(-Math.PI / 6);
    const step = 100;
    const cols = Math.ceil((W * 1.5) / step) + 3;
    const rows = Math.ceil((H * 1.5) / step) + 3;
    for (let r = -rows; r <= rows; r++) {
      for (let c = -cols; c <= cols; c++) {
        ctx.fillText('PAWTRAITS', c * 155, r * step);
      }
    }
    ctx.restore();

    // ‚îÄ‚îÄ Centre badge watermark ‚îÄ‚îÄ
    ctx.save();
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';
    const cx = W / 2, cy = H / 2;
    const pw = 230, ph = 44;
    // pill background
    ctx.fillStyle = 'rgba(0,0,0,0.60)';
    roundRect(ctx, cx - pw/2, cy - ph/2, pw, ph, 22);
    ctx.fill();
    // teal border
    ctx.strokeStyle = 'rgba(62,207,178,0.75)';
    ctx.lineWidth = 1.5;
    roundRect(ctx, cx - pw/2, cy - ph/2, pw, ph, 22);
    ctx.stroke();
    // text
    ctx.fillStyle = 'rgba(62,207,178,0.92)';
    ctx.font = 'bold 12px "Instrument Sans", Arial, sans-serif';
    ctx.fillText('‚ú¶  PAWTRAITS  ¬∑  PREVIEW ONLY  ‚ú¶', cx, cy);
    ctx.restore();

    // ‚îÄ‚îÄ Corner stamp ‚îÄ‚îÄ
    ctx.save();
    ctx.fillStyle = 'rgba(62,207,178,0.65)';
    ctx.font = '600 9px "Instrument Sans", Arial, sans-serif';
    ctx.textAlign = 'right';
    ctx.fillText('PAWTRAITS.COM', W - 8, H - 8);
    ctx.restore();

    // ‚îÄ‚îÄ Vignette ‚îÄ‚îÄ
    const vign = ctx.createRadialGradient(W/2, H/2, W*0.35, W/2, H/2, W*0.75);
    vign.addColorStop(0, 'transparent');
    vign.addColorStop(1, 'rgba(0,0,0,0.35)');
    ctx.fillStyle = vign;
    ctx.fillRect(0, 0, W, H);
  };
  img.onerror = () => {
    // If image load fails (e.g. CORS on URL), fallback to original
    if (imageSrc !== state.imageDataURL) {
      renderWatermarkedPreview(state.imageDataURL);
    }
  };
  img.src = imageSrc;

  // Update preview info
  document.getElementById('prev-cat').textContent = state.catLabel || '‚Äî';
}

function roundRect(ctx, x, y, w, h, r) {
  ctx.beginPath();
  ctx.moveTo(x + r, y);
  ctx.lineTo(x + w - r, y);
  ctx.quadraticCurveTo(x + w, y, x + w, y + r);
  ctx.lineTo(x + w, y + h - r);
  ctx.quadraticCurveTo(x + w, y + h, x + w - r, y + h);
  ctx.lineTo(x + r, y + h);
  ctx.quadraticCurveTo(x, y + h, x, y + h - r);
  ctx.lineTo(x, y + r);
  ctx.quadraticCurveTo(x, y, x + r, y);
  ctx.closePath();
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   STEP 5 ‚Äî PACKAGE
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function selectPkg(el) {
  document.querySelectorAll('.pkg-card').forEach(c => c.classList.remove('selected'));
  el.classList.add('selected');
  state.pkg      = el.dataset.pkg;
  state.pkgPrice = el.dataset.price;
  state.pkgLabel = el.querySelector('.pkg-name').textContent;
  document.getElementById('btn-next-5').disabled = false;
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   STEP 6 ‚Äî CHECKOUT
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function populateCheckout() {
  const canvas = document.getElementById('preview-canvas');
  if (canvas.width > 0) {
    document.getElementById('checkout-thumb').src = canvas.toDataURL('image/jpeg', 0.65);
  }
  document.getElementById('checkout-cat').textContent  = state.catLabel || '‚Äî';
  document.getElementById('checkout-pkg').textContent  = state.pkgLabel || '‚Äî';
  const d = pkgDetails[state.pkg] || {};
  document.getElementById('checkout-includes').textContent = d.includes || '‚Äî';
  document.getElementById('checkout-ship').textContent    = d.shipping || '‚Äî';
  document.getElementById('checkout-price').textContent   = state.pkgPrice || '‚Äî';
}

async function goToStripe() {
  const btn = document.querySelector('.pay-btn');
  btn.textContent = 'Preparing checkout‚Ä¶';
  btn.disabled = true;

  try {
    const res = await fetch('/api/checkout', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        pkg:              state.pkg,
        printifyImageId:  state.printifyImageId,
        printifyImageUrl: state.printifyImageUrl,
        catLabel:         state.catLabel,
      }),
    });

    const data = await res.json();
    if (!res.ok || !data.url) throw new Error(data.error || 'Could not create checkout session');
    window.location.href = data.url;

  } catch (err) {
    console.error('Checkout error:', err);
    btn.textContent = 'Proceed to Secure Checkout';
    btn.disabled = false;
    alert('Checkout failed: ' + err.message);
  }
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   UTILS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function delay(ms) { return new Promise(r => setTimeout(r, ms)); }

function blobToBase64(blob) {
  return new Promise((resolve, reject) => {
    const reader = new FileReader();
    reader.onload = () => resolve(reader.result);
    reader.onerror = reject;
    reader.readAsDataURL(blob);
  });
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   FAQ
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
document.querySelectorAll('.fq').forEach(btn => {
  btn.addEventListener('click', () => {
    const item = btn.closest('.fi');
    const ans  = item.querySelector('.fa');
    const open = item.classList.contains('open');
    document.querySelectorAll('.fi.open').forEach(i => { i.classList.remove('open'); i.querySelector('.fa').style.maxHeight = null; });
    if (!open) { item.classList.add('open'); ans.style.maxHeight = ans.scrollHeight + 'px'; }
  });
});

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   SCROLL REVEAL
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
const obs = new IntersectionObserver(entries => {
  entries.forEach((e, i) => {
    if (e.isIntersecting) { setTimeout(() => e.target.classList.add('visible'), 80 * i); obs.unobserve(e.target); }
  });
}, { threshold: .1 });
document.querySelectorAll('.reveal').forEach(el => obs.observe(el));
</script>
</body>
</html>