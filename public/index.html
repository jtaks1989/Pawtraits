<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Pawtraits ‚Äî Renaissance Portraits</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,700;0,900;1,700;1,900&family=DM+Serif+Display:ital@0;1&family=Instrument+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --black:#080808;--deep:#0e0e0e;--surface:#161616;--card:#111111;
      --border:rgba(255,255,255,0.08);--bh:rgba(255,255,255,0.15);
      --white:#f4f0ea;--muted:rgba(244,240,234,0.45);
      --teal:#3ecfb2;--teal-dk:#2aab92;--gold:#c8a84b;--red:#e05555;
    }
    *,*::before,*::after{box-sizing:border-box;margin:0;padding:0;}
    html{scroll-behavior:smooth;}
    body{background:var(--black);color:var(--white);font-family:'Instrument Sans',sans-serif;font-size:16px;line-height:1.6;overflow-x:hidden;min-height:100vh;}
    body::after{content:'';position:fixed;inset:0;pointer-events:none;z-index:9999;opacity:.026;background:url("data:image/svg+xml,%3Csvg viewBox='0 0 512 512' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='g'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.75' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23g)'/%3E%3C/svg%3E");background-size:200px;}
    nav{position:sticky;top:0;z-index:300;display:flex;align-items:center;justify-content:space-between;padding:.9rem 2rem;background:rgba(8,8,8,.94);backdrop-filter:blur(20px);border-bottom:1px solid var(--border);}
    .logo{font-family:'DM Serif Display',serif;font-size:1.15rem;color:var(--white);text-decoration:none;}
    .logo span{color:var(--teal);}
    .nav-right{display:flex;gap:1.25rem;align-items:center;}
    .nav-link{font-size:.82rem;color:var(--muted);text-decoration:none;transition:color .2s;background:none;border:none;cursor:pointer;}
    .nav-link:hover{color:var(--white);}
    .nav-api-btn{display:flex;align-items:center;gap:.4rem;font-size:.78rem;font-weight:500;padding:.42rem .9rem;border:1px solid rgba(62,207,178,.4);border-radius:100px;background:rgba(62,207,178,.07);color:var(--teal);}
    .api-dot{width:6px;height:6px;border-radius:50%;background:var(--teal);box-shadow:0 0 6px var(--teal);}
    .hero{text-align:center;padding:5.5rem 1.5rem 4.5rem;position:relative;overflow:hidden;}
    .hero-glow{position:absolute;width:600px;height:600px;border-radius:50%;background:radial-gradient(ellipse,rgba(62,207,178,.065) 0%,transparent 68%);top:50%;left:50%;transform:translate(-50%,-50%);pointer-events:none;}
    .hero-eyebrow{display:inline-flex;align-items:center;gap:.5rem;font-size:.7rem;font-weight:500;letter-spacing:.15em;text-transform:uppercase;color:var(--teal);margin-bottom:1.5rem;animation:fadeUp .7s ease both;}
    .hero-eyebrow::before,.hero-eyebrow::after{content:'';display:block;width:22px;height:1px;background:var(--teal);}
    .hero h1{font-family:'Playfair Display',serif;font-size:clamp(2.6rem,7vw,6rem);font-style:italic;font-weight:900;line-height:.95;letter-spacing:-.02em;color:var(--white);margin-bottom:1.5rem;animation:fadeUp .7s .1s ease both;}
    .hero h1 .accent{color:var(--teal);}
    .hero-sub{font-size:1rem;color:var(--muted);max-width:420px;margin:0 auto 2.25rem;line-height:1.7;animation:fadeUp .7s .2s ease both;}
    .hero-sub strong{color:var(--white);font-weight:500;}
    .hero-rating{display:flex;align-items:center;gap:.85rem;justify-content:center;flex-wrap:wrap;font-size:.82rem;color:var(--muted);animation:fadeUp .7s .3s ease both;}
    .hero-rating strong{color:var(--white);}
    .stars{color:#00b67a;letter-spacing:.05em;}
    .rsep{width:1px;height:14px;background:var(--bh);}
    .wizard-wrap{max-width:840px;margin:0 auto;padding:0 1.5rem 8rem;}
    .progress-bar{display:flex;align-items:flex-start;margin-bottom:3.5rem;}
    .pb-step{display:flex;flex-direction:column;align-items:center;flex:1;position:relative;}
    .pb-step::before{content:'';position:absolute;top:15px;left:50%;right:-50%;height:2px;background:var(--border);z-index:0;}
    .pb-step:last-child::before{display:none;}
    .pb-dot{width:30px;height:30px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:.72rem;font-weight:600;background:var(--surface);border:2px solid var(--border);color:var(--muted);position:relative;z-index:1;transition:all .35s;}
    .pb-step.done .pb-dot{background:var(--teal);border-color:var(--teal);color:var(--black);}
    .pb-step.done .pb-dot span{display:none;}
    .pb-step.done .pb-dot::after{content:'‚úì';font-size:.72rem;}
    .pb-step.active .pb-dot{background:var(--teal);border-color:var(--teal);color:var(--black);box-shadow:0 0 0 4px rgba(62,207,178,.2);}
    .pb-fill{position:absolute;top:15px;left:50%;right:-50%;height:2px;background:var(--teal);z-index:0;transform-origin:left;transform:scaleX(0);transition:transform .45s ease;}
    .pb-step.done .pb-fill{transform:scaleX(1);}
    .pb-label{font-size:.63rem;font-weight:500;letter-spacing:.06em;text-transform:uppercase;color:var(--muted);margin-top:.5rem;text-align:center;white-space:nowrap;transition:color .3s;}
    .pb-step.active .pb-label,.pb-step.done .pb-label{color:var(--teal);}
    .step-panel{display:none;animation:fadeUp .4s ease both;}
    .step-panel.active{display:block;}
    .step-heading{font-family:'Playfair Display',serif;font-size:clamp(1.7rem,3.5vw,2.5rem);font-style:italic;font-weight:900;color:var(--white);margin-bottom:.45rem;text-align:center;}
    .step-heading .accent{color:var(--teal);}
    .step-desc{font-size:.92rem;color:var(--muted);text-align:center;margin-bottom:2.5rem;line-height:1.65;}
    .cat-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:.85rem;}
    .cat-card{background:var(--card);border:1.5px solid var(--border);border-radius:14px;padding:1.6rem 1.2rem;cursor:pointer;transition:border-color .25s,background .25s,transform .25s;text-align:center;display:flex;flex-direction:column;gap:.55rem;align-items:center;}
    .cat-card:hover{border-color:var(--bh);background:#1a1a1a;transform:translateY(-3px);}
    .cat-card.selected{border-color:var(--teal);background:rgba(62,207,178,.07);box-shadow:0 0 0 1px var(--teal);}
    .cat-icon{font-size:2rem;line-height:1;}
    .cat-title{font-family:'DM Serif Display',serif;font-size:1rem;color:var(--white);}
    .cat-desc{font-size:.78rem;color:var(--muted);line-height:1.5;}
    .upload-zone{border:2px dashed rgba(62,207,178,.3);border-radius:16px;background:rgba(62,207,178,.025);padding:3.5rem 2rem;text-align:center;cursor:pointer;position:relative;transition:border-color .25s,background .25s;}
    .upload-zone:hover,.upload-zone.drag-over{border-color:var(--teal);background:rgba(62,207,178,.065);}
    .upload-zone input[type=file]{position:absolute;inset:0;opacity:0;cursor:pointer;width:100%;height:100%;}
    .upload-icon{font-size:2.8rem;margin-bottom:.85rem;opacity:.7;}
    .upload-zone h3{font-family:'DM Serif Display',serif;font-size:1.35rem;color:var(--white);margin-bottom:.4rem;}
    .upload-zone p{font-size:.88rem;color:var(--muted);margin-bottom:.3rem;}
    .upload-zone small{font-size:.7rem;color:rgba(244,240,234,.28);letter-spacing:.08em;text-transform:uppercase;}
    .upload-tips{display:flex;gap:.75rem;justify-content:center;flex-wrap:wrap;margin-top:1.75rem;}
    .upload-tip{display:flex;align-items:center;gap:.35rem;font-size:.78rem;color:var(--muted);background:var(--surface);border:1px solid var(--border);border-radius:100px;padding:.3rem .8rem;}
    .upload-tip::before{content:'‚úì';color:var(--teal);font-size:.68rem;}
    .gen-wrap{text-align:center;padding:2.5rem 0;}
    .gen-spinner{width:72px;height:72px;border-radius:50%;border:3px solid rgba(62,207,178,.15);border-top-color:var(--teal);animation:spin 1s linear infinite;margin:0 auto 2rem;}
    @keyframes spin{to{transform:rotate(360deg);}}
    .gen-title{font-family:'DM Serif Display',serif;font-size:1.5rem;color:var(--white);margin-bottom:.6rem;}
    .gen-status{font-size:.88rem;color:var(--teal);margin-bottom:2rem;min-height:1.4em;}
    .gen-steps{display:flex;flex-direction:column;gap:.6rem;max-width:340px;margin:0 auto;}
    .gen-step{display:flex;align-items:center;gap:.75rem;padding:.6rem 1rem;border-radius:8px;background:var(--surface);border:1px solid var(--border);font-size:.84rem;color:var(--muted);text-align:left;transition:all .3s;}
    .gen-step.active{border-color:rgba(62,207,178,.35);color:var(--white);background:rgba(62,207,178,.06);}
    .gen-step.done{border-color:rgba(62,207,178,.2);color:rgba(244,240,234,.5);}
    .gen-step-ico{font-size:1rem;flex-shrink:0;}
    .gen-step.active .gen-step-ico{animation:pulse 1.2s ease infinite;}
    @keyframes pulse{0%,100%{opacity:1;}50%{opacity:.4;}}
    .gen-step-check{font-size:.75rem;color:var(--teal);margin-left:auto;flex-shrink:0;}
    .gen-error{display:none;background:rgba(224,85,85,.08);border:1px solid rgba(224,85,85,.25);border-radius:10px;padding:1.5rem;margin-top:1.5rem;text-align:left;}
    .gen-error.visible{display:block;}
    .gen-error-title{font-size:.82rem;font-weight:600;color:var(--red);margin-bottom:.5rem;}
    .gen-error-msg{font-size:.82rem;color:rgba(244,240,234,.6);line-height:1.6;}
    .gen-error-actions{display:flex;gap:.75rem;margin-top:1rem;flex-wrap:wrap;}
    .gen-retry-btn{font-size:.82rem;font-weight:600;padding:.55rem 1.25rem;background:var(--red);color:white;border:none;border-radius:6px;cursor:pointer;}
    .gen-skip-btn{font-size:.82rem;font-weight:500;padding:.55rem 1.25rem;background:none;border:1px solid var(--border);border-radius:6px;color:var(--muted);cursor:pointer;}
    .preview-wrap{display:flex;flex-direction:column;align-items:center;gap:1.75rem;}
    .preview-frame{position:relative;display:inline-block;border-radius:12px;overflow:hidden;box-shadow:0 0 0 1px var(--border),0 24px 60px rgba(0,0,0,.6);max-width:400px;width:100%;}
    .preview-frame canvas{display:block;width:100%;height:auto;border-radius:12px;}
    .preview-badge{position:absolute;bottom:.85rem;left:50%;transform:translateX(-50%);background:rgba(0,0,0,.72);backdrop-filter:blur(8px);border:1px solid rgba(62,207,178,.3);border-radius:100px;padding:.35rem 1rem;font-size:.68rem;font-weight:600;letter-spacing:.1em;text-transform:uppercase;color:var(--teal);white-space:nowrap;}
    .preview-info{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:1.4rem;width:100%;max-width:400px;}
    .preview-info-title{font-size:.65rem;font-weight:500;letter-spacing:.12em;text-transform:uppercase;color:var(--teal);margin-bottom:.9rem;}
    .preview-row{display:flex;justify-content:space-between;font-size:.86rem;padding:.5rem 0;border-bottom:1px solid var(--border);color:var(--muted);}
    .preview-row:last-child{border-bottom:none;}
    .preview-row span:last-child{color:var(--white);font-weight:500;}
    .pkg-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:1rem;align-items:start;}
    .pkg-card{background:var(--card);border:1.5px solid var(--border);border-radius:14px;padding:1.85rem 1.4rem;cursor:pointer;transition:border-color .25s,background .25s,transform .25s;display:flex;flex-direction:column;position:relative;}
    .pkg-card:hover{border-color:var(--bh);transform:translateY(-3px);}
    .pkg-card.selected{border-color:var(--teal);background:rgba(62,207,178,.055);box-shadow:0 0 0 1px var(--teal);}
    .pkg-badge-pop{position:absolute;top:-13px;left:50%;transform:translateX(-50%);background:var(--teal);color:var(--black);font-size:.6rem;font-weight:700;letter-spacing:.1em;text-transform:uppercase;padding:.28rem .8rem;border-radius:100px;white-space:nowrap;}
    .pkg-badge-val{position:absolute;top:-13px;left:50%;transform:translateX(-50%);background:var(--black);color:var(--white);font-size:.6rem;font-weight:700;letter-spacing:.1em;text-transform:uppercase;padding:.26rem .8rem;border-radius:100px;border:1.5px solid rgba(255,255,255,.28);white-space:nowrap;}
    .pkg-incl{display:flex;justify-content:center;margin-bottom:1rem;}
    .pkg-incl span{font-size:.66rem;font-weight:500;padding:.2rem .65rem;border-radius:100px;background:rgba(62,207,178,.14);color:var(--teal);}
    .pkg-name{font-family:'DM Serif Display',serif;font-size:1.4rem;color:var(--white);text-align:center;margin-bottom:.8rem;}
    .pkg-price{font-size:3.2rem;font-weight:800;line-height:1;color:var(--white);text-align:center;margin-bottom:.3rem;}
    .pkg-price sup{font-size:1.4rem;vertical-align:super;font-weight:700;}
    .pkg-count{font-size:.82rem;color:var(--muted);text-align:center;margin-bottom:1.4rem;}
    .pkg-feats{list-style:none;display:flex;flex-direction:column;gap:.55rem;margin-bottom:1.5rem;flex:1;}
    .pkg-feats li{font-size:.8rem;color:rgba(244,240,234,.7);display:flex;align-items:flex-start;gap:.5rem;line-height:1.4;}
    .pkg-feats li::before{content:'‚úì';color:var(--teal);font-size:.7rem;flex-shrink:0;margin-top:.15rem;font-weight:700;}
    .pkg-sel-btn{display:block;width:100%;padding:.85rem;border-radius:8px;font-size:.86rem;font-weight:600;background:var(--white);color:var(--black);border:none;cursor:pointer;text-align:center;transition:background .2s;}
    .pkg-card.selected .pkg-sel-btn{background:var(--teal);}
    .pkg-sel-btn:hover{background:var(--teal);}
    .checkout-wrap{max-width:500px;margin:0 auto;}
    .order-summary{background:var(--card);border:1px solid var(--border);border-radius:14px;overflow:hidden;margin-bottom:1.4rem;}
    .os-header{background:var(--surface);padding:1.1rem 1.5rem;font-size:.68rem;font-weight:500;letter-spacing:.12em;text-transform:uppercase;color:var(--teal);border-bottom:1px solid var(--border);}
    .os-body{padding:1.4rem 1.5rem;display:flex;flex-direction:column;gap:.9rem;}
    .os-row{display:flex;justify-content:space-between;align-items:flex-start;font-size:.88rem;}
    .os-label{color:var(--muted);flex-shrink:0;}
    .os-val{color:var(--white);font-weight:500;text-align:right;max-width:58%;}
    .os-thumb{width:52px;height:52px;border-radius:8px;object-fit:cover;border:1px solid var(--border);flex-shrink:0;}
    .os-divider{border:none;border-top:1px solid var(--border);}
    .os-total{display:flex;justify-content:space-between;align-items:center;font-size:1rem;font-weight:600;}
    .os-total .os-price{font-size:1.55rem;font-weight:800;color:var(--teal);}
    .pay-methods{display:flex;align-items:center;gap:.45rem;flex-wrap:wrap;margin-bottom:.9rem;}
    .pay-chip{font-size:.66rem;font-weight:600;padding:.25rem .6rem;background:var(--surface);border:1px solid var(--border);border-radius:4px;color:var(--muted);}
    .pay-secure{display:flex;align-items:center;gap:.35rem;font-size:.73rem;color:var(--muted);margin-left:auto;}
    .pay-note{font-size:.8rem;color:var(--muted);line-height:1.65;background:var(--surface);border:1px solid var(--border);border-radius:8px;padding:.95rem 1.15rem;margin-bottom:1.4rem;}
    .pay-note strong{color:var(--white);font-weight:500;}
    .pay-btn{width:100%;padding:1.05rem;font-family:'Instrument Sans',sans-serif;font-size:.98rem;font-weight:700;background:var(--teal);color:var(--black);border:none;border-radius:10px;cursor:pointer;transition:background .2s,transform .2s,box-shadow .2s;}
    .pay-btn:hover{background:#5de0c8;transform:translateY(-2px);box-shadow:0 8px 28px rgba(62,207,178,.25);}
    .step-nav{display:flex;align-items:center;justify-content:space-between;margin-top:2.25rem;gap:1rem;}
    .btn-back{display:flex;align-items:center;gap:.45rem;font-size:.84rem;font-weight:500;color:var(--muted);background:none;border:1px solid var(--border);border-radius:8px;padding:.65rem 1.2rem;cursor:pointer;transition:color .2s,border-color .2s;}
    .btn-back:hover{color:var(--white);border-color:var(--bh);}
    .btn-next{display:flex;align-items:center;gap:.45rem;font-size:.88rem;font-weight:600;color:var(--black);background:var(--teal);border:none;border-radius:8px;padding:.75rem 1.9rem;cursor:pointer;transition:background .2s,transform .2s,box-shadow .2s;margin-left:auto;}
    .btn-next:hover{background:#5de0c8;transform:translateY(-2px);box-shadow:0 6px 22px rgba(62,207,178,.22);}
    .btn-next:disabled{opacity:.38;cursor:not-allowed;transform:none!important;box-shadow:none!important;}
    .info-section{padding:5rem 1.5rem;}
    .info-inner{max-width:960px;margin:0 auto;}
    .stag{display:inline-flex;align-items:center;gap:.4rem;font-size:.68rem;font-weight:500;letter-spacing:.12em;text-transform:uppercase;color:var(--teal);margin-bottom:1rem;}
    .stag::before{content:'';display:block;width:18px;height:1px;background:var(--teal);}
    .sh{font-family:'Playfair Display',serif;font-size:clamp(1.8rem,3.5vw,2.9rem);font-style:italic;font-weight:900;line-height:1.1;color:var(--white);margin-bottom:.85rem;}
    .ssub{font-size:.92rem;color:var(--muted);max-width:460px;line-height:1.7;}
    .how-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1.15rem;margin-top:2.75rem;}
    .how-card{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:1.6rem;transition:border-color .3s;}
    .how-card:hover{border-color:var(--bh);}
    .how-num{font-family:'Playfair Display',serif;font-size:2.2rem;font-style:italic;font-weight:900;color:rgba(62,207,178,.12);line-height:1;margin-bottom:.75rem;}
    .how-ico{font-size:1.3rem;margin-bottom:.6rem;}
    .how-title{font-family:'DM Serif Display',serif;font-size:1rem;color:var(--white);margin-bottom:.35rem;}
    .how-desc{font-size:.83rem;color:var(--muted);line-height:1.6;}
    .rev-strip{background:var(--deep);border-top:1px solid var(--border);border-bottom:1px solid var(--border);padding:5rem 1.5rem;}
    .rev-inner{max-width:960px;margin:0 auto;}
    .rev-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:1rem;margin-top:2.75rem;}
    .rv{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:1.4rem;transition:border-color .3s;}
    .rv:hover{border-color:var(--bh);}
    .rv-stars{color:#00b67a;font-size:.8rem;margin-bottom:.8rem;letter-spacing:.1em;}
    .rv-text{font-size:.88rem;color:rgba(244,240,234,.78);font-style:italic;line-height:1.7;margin-bottom:1rem;}
    .rv-author{font-size:.73rem;color:var(--muted);display:flex;align-items:center;gap:.5rem;}
    .rv-av{width:26px;height:26px;border-radius:50%;background:rgba(62,207,178,.14);border:1px solid rgba(62,207,178,.3);display:flex;align-items:center;justify-content:center;font-size:.72rem;color:var(--teal);font-weight:600;}
    .faq-list{margin-top:2.5rem;}
    .fi{border-bottom:1px solid var(--border);}
    .fq{width:100%;background:none;border:none;text-align:left;padding:1.2rem 0;font-family:'DM Serif Display',serif;font-size:1rem;color:var(--white);cursor:pointer;display:flex;justify-content:space-between;align-items:center;gap:1rem;}
    .fq::after{content:'+';font-size:1.25rem;color:var(--teal);flex-shrink:0;font-weight:300;transition:transform .3s;}
    .fi.open .fq::after{transform:rotate(45deg);}
    .fa{max-height:0;overflow:hidden;transition:max-height .4s ease;}
    .fa p{padding-bottom:1.2rem;font-size:.87rem;color:var(--muted);line-height:1.75;}
    footer{background:#050505;border-top:1px solid var(--border);padding:2.5rem 2rem;}
    .footer-inner{max-width:960px;margin:0 auto;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:1.25rem;}
    .footer-logo{font-family:'DM Serif Display',serif;font-size:1.05rem;}
    .footer-logo span{color:var(--teal);}
    .footer-links{display:flex;gap:1.25rem;flex-wrap:wrap;}
    .footer-links a{font-size:.8rem;color:var(--muted);text-decoration:none;transition:color .2s;}
    .footer-links a:hover{color:var(--teal);}
    .footer-copy{font-size:.73rem;color:rgba(244,240,234,.22);text-align:center;padding-top:1.25rem;border-top:1px solid var(--border);max-width:960px;margin:1.25rem auto 0;}
    .reveal{opacity:0;transform:translateY(20px);transition:opacity .6s ease,transform .6s ease;}
    .reveal.visible{opacity:1;transform:none;}
    @keyframes fadeUp{from{opacity:0;transform:translateY(24px);}to{opacity:1;transform:translateY(0);}}
    @media(max-width:680px){
      .cat-grid{grid-template-columns:repeat(2,1fr);}
      .pkg-grid{grid-template-columns:1fr;max-width:360px;margin:0 auto;}
      .pb-label{display:none;}
      .hero h1{font-size:2.5rem;}
      nav{padding:.85rem 1.1rem;}
      .wizard-wrap{padding:0 1rem 6rem;}
    }
  </style>
</head>
<body>

<nav>
  <a class="logo" href="#">Pawtraits<span>.</span></a>
  <div class="nav-right">
    <a class="nav-link" href="#how-it-works">How It Works</a>
    <a class="nav-link" href="#faq">FAQ</a>
    <div class="nav-api-btn"><span class="api-dot"></span><span>Grok AI Active</span></div>
  </div>
</nav>

<section class="hero">
  <div class="hero-glow"></div>
  <div class="hero-eyebrow">Powered by Grok AI</div>
  <h1>Upload. Generate.<br><span class="accent">Immortalise.</span></h1>
  <p class="hero-sub">Upload your photo ‚Äî our AI paints it as a Renaissance masterpiece. <strong>Printed on museum-grade canvas and shipped to your door.</strong></p>
  <div class="hero-rating">
    <div class="stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
    <strong>4.9 / 5</strong>
    <div class="rsep"></div>
    <span>2,400+ portraits delivered</span>
    <div class="rsep"></div>
    <span>Ships worldwide</span>
  </div>
</section>

<div class="wizard-wrap">
  <div class="progress-bar" id="progress-bar">
    <div class="pb-step active" data-step="1"><div class="pb-dot"><span>1</span></div><div class="pb-fill"></div><div class="pb-label">Subject</div></div>
    <div class="pb-step" data-step="2"><div class="pb-dot"><span>2</span></div><div class="pb-fill"></div><div class="pb-label">Upload</div></div>
    <div class="pb-step" data-step="3"><div class="pb-dot"><span>3</span></div><div class="pb-fill"></div><div class="pb-label">Generating</div></div>
    <div class="pb-step" data-step="4"><div class="pb-dot"><span>4</span></div><div class="pb-fill"></div><div class="pb-label">Preview</div></div>
    <div class="pb-step" data-step="5"><div class="pb-dot"><span>5</span></div><div class="pb-fill"></div><div class="pb-label">Package</div></div>
    <div class="pb-step" data-step="6"><div class="pb-dot"><span>6</span></div><div class="pb-fill"></div><div class="pb-label">Checkout</div></div>
  </div>

  <!-- STEP 1 -->
  <div class="step-panel active" id="step-1">
    <h2 class="step-heading">What would you like to <span class="accent">immortalise?</span></h2>
    <p class="step-desc">Choose your portrait category ‚Äî our AI will style it accordingly.</p>
    <div class="cat-grid">
      <div class="cat-card" data-cat="pets" onclick="selectCat(this)"><div class="cat-icon">üêæ</div><div class="cat-title">Pets</div><div class="cat-desc">Dogs, cats, rabbits, birds ‚Äî any beloved companion</div></div>
      <div class="cat-card" data-cat="family" onclick="selectCat(this)"><div class="cat-icon">üë®‚Äçüë©‚Äçüëß</div><div class="cat-title">Family</div><div class="cat-desc">The whole household in one masterpiece</div></div>
      <div class="cat-card" data-cat="children" onclick="selectCat(this)"><div class="cat-icon">üßí</div><div class="cat-title">Children</div><div class="cat-desc">Crown your little one for the ages</div></div>
      <div class="cat-card" data-cat="couples" onclick="selectCat(this)"><div class="cat-icon">üíë</div><div class="cat-title">Couples</div><div class="cat-desc">Weddings, anniversaries, or simply love</div></div>
      <div class="cat-card" data-cat="self" onclick="selectCat(this)"><div class="cat-icon">ü™û</div><div class="cat-title">Self-Portrait</div><div class="cat-desc">You, rendered as a 17th-century noble</div></div>
    </div>
    <div class="step-nav"><div></div><button class="btn-next" id="btn-next-1" disabled onclick="goToStep(2)">Continue &nbsp;‚Üí</button></div>
  </div>

  <!-- STEP 2 -->
  <div class="step-panel" id="step-2">
    <h2 class="step-heading">Upload your <span class="accent">photo</span></h2>
    <p class="step-desc">Share a clear, well-lit photo. The face should be visible and in focus.</p>
    <div class="upload-zone" id="upload-zone">
      <input type="file" id="photo-input" accept="image/*" onchange="handleFile(this.files[0])">
      <div class="upload-icon">üì∏</div>
      <h3>Drop your photo here</h3>
      <p>or click anywhere to browse</p>
      <small>JPG ¬∑ PNG ¬∑ HEIC &nbsp;¬∑&nbsp; Max 20 MB</small>
    </div>
    <div class="upload-tips">
      <div class="upload-tip">Face clearly visible</div>
      <div class="upload-tip">Good natural lighting</div>
      <div class="upload-tip">Sharp focus</div>
      <div class="upload-tip">Front-facing works best</div>
    </div>
    <div class="step-nav">
      <button class="btn-back" onclick="goToStep(1)">‚Üê Back</button>
      <button class="btn-next" id="btn-next-2" disabled onclick="startGeneration()">Generate Portrait &nbsp;‚Üí</button>
    </div>
  </div>

  <!-- STEP 3 -->
  <div class="step-panel" id="step-3">
    <h2 class="step-heading">Creating your <span class="accent">masterpiece</span></h2>
    <p class="step-desc">Grok AI is painting your Renaissance portrait. This takes about 20‚Äì30 seconds.</p>
    <div class="gen-wrap">
      <div class="gen-spinner" id="gen-spinner"></div>
      <div class="gen-title" id="gen-title">Analysing your photo‚Ä¶</div>
      <div class="gen-status" id="gen-status">Studying your subject with Grok Vision</div>
      <div class="gen-steps">
        <div class="gen-step active" id="gstep-1"><span class="gen-step-ico">üîç</span><span>Analysing subject with Grok Vision</span><span class="gen-step-check" id="gcheck-1" style="display:none">‚úì</span></div>
        <div class="gen-step" id="gstep-2"><span class="gen-step-ico">üé®</span><span>Crafting Renaissance portrait prompt</span><span class="gen-step-check" id="gcheck-2" style="display:none">‚úì</span></div>
        <div class="gen-step" id="gstep-3"><span class="gen-step-ico">üñºÔ∏è</span><span>Generating masterpiece with Grok Imagine</span><span class="gen-step-check" id="gcheck-3" style="display:none">‚úì</span></div>
        <div class="gen-step" id="gstep-4"><span class="gen-step-ico">‚ú®</span><span>Applying finishing touches</span><span class="gen-step-check" id="gcheck-4" style="display:none">‚úì</span></div>
      </div>
      <div class="gen-error" id="gen-error">
        <div class="gen-error-title" id="gen-error-title">Generation failed</div>
        <div class="gen-error-msg" id="gen-error-msg">An error occurred.</div>
        <div class="gen-error-actions">
          <button class="gen-retry-btn" onclick="startGeneration()">Retry</button>
          <button class="gen-skip-btn" onclick="showFallbackPreview()">Continue with preview photo</button>
        </div>
      </div>
    </div>
  </div>

  <!-- STEP 4 -->
  <div class="step-panel" id="step-4">
    <h2 class="step-heading">Your AI <span class="accent">portrait</span></h2>
    <p class="step-desc">Your masterpiece is ready. Select a package to receive your full-resolution, watermark-free print.</p>
    <div class="preview-wrap">
      <div class="preview-frame">
        <canvas id="preview-canvas"></canvas>
        <div class="preview-badge">‚ú¶ &nbsp; Watermarked Preview</div>
      </div>
      <div class="preview-info">
        <div class="preview-info-title">Your commission details</div>
        <div class="preview-row"><span>Category</span><span id="prev-cat">‚Äî</span></div>
        <div class="preview-row"><span>Style</span><span>Old Masters Renaissance</span></div>
        <div class="preview-row"><span>Generated by</span><span style="color:var(--teal)">Grok AI ‚ú¶</span></div>
        <div class="preview-row"><span>Status</span><span style="color:var(--teal)">‚úì Portrait ready</span></div>
      </div>
    </div>
    <div class="step-nav">
      <button class="btn-back" onclick="goToStep(2)">‚Üê Retake photo</button>
      <button class="btn-next" onclick="goToStep(5)">Choose Package &nbsp;‚Üí</button>
    </div>
  </div>

  <!-- STEP 5 -->
  <div class="step-panel" id="step-5">
    <h2 class="step-heading">Choose your <span class="accent">package</span></h2>
    <p class="step-desc">All packages use museum-grade 425 GSM archival canvas. Printed and shipped to your door.</p>
    <div class="pkg-grid">
      <div class="pkg-card" data-pkg="squire" data-price="$49" onclick="selectPkg(this)">
        <div class="pkg-badge-pop">POPULAR</div>
        <div class="pkg-incl"><span>+ Digital File Included</span></div>
        <div class="pkg-name">Squire Pack</div>
        <div class="pkg-price"><sup>$</sup>49</div>
        <div class="pkg-count">20 √ó 25 cm &nbsp;(8√ó10 in)</div>
        <ul class="pkg-feats">
          <li>425 GSM archival canvas</li>
          <li>Museum-grade colour printing</li>
          <li>Gallery-wrapped, ready to hang</li>
          <li>High-res digital file included</li>
          <li>Shipped to your door</li>
          <li>Ships in 7‚Äì10 business days</li>
        </ul>
        <button class="pkg-sel-btn">Select Squire</button>
      </div>
      <div class="pkg-card" data-pkg="noble" data-price="$89" onclick="selectPkg(this)">
        <div class="pkg-badge-pop">MOST POPULAR</div>
        <div class="pkg-incl"><span>+ Digital File Included</span></div>
        <div class="pkg-name">Noble Pack</div>
        <div class="pkg-price"><sup>$</sup>89</div>
        <div class="pkg-count">30 √ó 40 cm &nbsp;(12√ó16 in)</div>
        <ul class="pkg-feats">
          <li>425 GSM archival canvas</li>
          <li>Museum-grade colour printing</li>
          <li>Gallery-wrapped, ready to hang</li>
          <li>High-res digital file included</li>
          <li>Priority processing</li>
          <li>Ships in 7‚Äì10 business days</li>
        </ul>
        <button class="pkg-sel-btn">Select Noble</button>
      </div>
      <div class="pkg-card" data-pkg="royal" data-price="$149" onclick="selectPkg(this)">
        <div class="pkg-badge-val">BEST VALUE</div>
        <div class="pkg-incl"><span>+ Digital File Included</span></div>
        <div class="pkg-name">Royal Pack</div>
        <div class="pkg-price"><sup>$</sup>149</div>
        <div class="pkg-count">45 √ó 60 cm &nbsp;(18√ó24 in)</div>
        <ul class="pkg-feats">
          <li>425 GSM archival canvas</li>
          <li>Museum-grade colour printing</li>
          <li>Gallery-wrapped, ready to hang</li>
          <li>High-res digital file included</li>
          <li>Up to 3 subjects</li>
          <li>Ships in 7‚Äì10 business days</li>
        </ul>
        <button class="pkg-sel-btn">Select Royal</button>
      </div>
    </div>
    <div class="step-nav">
      <button class="btn-back" onclick="goToStep(4)">‚Üê Back</button>
      <button class="btn-next" id="btn-next-5" disabled onclick="goToStep(6)">Review Order &nbsp;‚Üí</button>
    </div>
  </div>

  <!-- STEP 6 -->
  <div class="step-panel" id="step-6">
    <h2 class="step-heading">Review &amp; <span class="accent">pay</span></h2>
    <p class="step-desc">You'll be taken to Stripe's secure checkout where you'll enter your delivery address and payment details.</p>
    <div class="checkout-wrap">
      <div class="order-summary">
        <div class="os-header">Order Summary</div>
        <div class="os-body">
          <div class="os-row"><span class="os-label">Your portrait</span><img class="os-thumb" id="checkout-thumb" src="" alt=""></div>
          <hr class="os-divider">
          <div class="os-row"><span class="os-label">Category</span><span class="os-val" id="checkout-cat">‚Äî</span></div>
          <div class="os-row"><span class="os-label">Generated by</span><span class="os-val" style="color:var(--teal)">Grok AI ‚ú¶</span></div>
          <div class="os-row"><span class="os-label">Package</span><span class="os-val" id="checkout-pkg">‚Äî</span></div>
          <div class="os-row"><span class="os-label">Size</span><span class="os-val" id="checkout-includes">‚Äî</span></div>
          <div class="os-row"><span class="os-label">Shipping</span><span class="os-val" id="checkout-ship">‚Äî</span></div>
          <hr class="os-divider">
          <div class="os-total"><span>Total</span><span class="os-price" id="checkout-price">‚Äî</span></div>
        </div>
      </div>
      <div class="pay-note">
        After clicking below you'll be taken to <strong>Stripe's secure checkout</strong> where you enter your delivery address and card details. Your portrait is printed on 425 GSM archival canvas and shipped directly to you.
      </div>
      <div class="pay-methods">
        <div class="pay-chip">VISA</div>
        <div class="pay-chip">Mastercard</div>
        <div class="pay-chip">AMEX</div>
        <div class="pay-chip">Apple Pay</div>
        <div class="pay-chip">Google Pay</div>
        <div class="pay-secure">üîí Stripe secured</div>
      </div>
      <button class="pay-btn" onclick="goToStripe()">Enter Delivery Details &amp; Pay</button>
      <div class="step-nav" style="margin-top:1rem;">
        <button class="btn-back" onclick="goToStep(5)">‚Üê Change package</button>
      </div>
    </div>
  </div>
</div>

<!-- HOW IT WORKS -->
<div id="how-it-works" style="background:var(--deep);border-top:1px solid var(--border);">
  <div class="info-section">
    <div class="info-inner">
      <p class="stag reveal">The Process</p>
      <h2 class="sh reveal">How it works</h2>
      <div class="how-grid">
        <div class="how-card reveal"><div class="how-num">01</div><div class="how-ico">üñºÔ∏è</div><div class="how-title">Pick your subject</div><p class="how-desc">Choose from pets, family, couples, children, or a self-portrait.</p></div>
        <div class="how-card reveal"><div class="how-num">02</div><div class="how-ico">üì∏</div><div class="how-title">Upload your photo</div><p class="how-desc">A clear, well-lit photo. Grok Vision analyses your subject instantly.</p></div>
        <div class="how-card reveal"><div class="how-num">03</div><div class="how-ico">ü§ñ</div><div class="how-title">AI paints the portrait</div><p class="how-desc">Grok Imagine renders your subject in old-master style in about 20‚Äì30 seconds.</p></div>
        <div class="how-card reveal"><div class="how-num">04</div><div class="how-ico">üì¶</div><div class="how-title">Print &amp; delivery</div><p class="how-desc">Printed on 425 GSM museum-grade archival canvas and shipped worldwide in 7‚Äì10 days.</p></div>
      </div>
    </div>
  </div>
</div>

<!-- REVIEWS -->
<div class="rev-strip" id="reviews">
  <div class="rev-inner">
    <div style="display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:1rem;">
      <div><p class="stag reveal">Social Proof</p><h2 class="sh reveal">What our patrons say</h2></div>
      <div class="reveal" style="text-align:right;"><div class="stars" style="font-size:1.15rem;">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div><div style="font-size:.78rem;color:var(--muted);margin-top:.25rem;">4.9 ¬∑ 2,400+ reviews</div></div>
    </div>
    <div class="rev-grid">
      <div class="rv reveal"><div class="rv-stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div><p class="rv-text">"I cannot stop staring at it. Max dressed in full 17th-century regalia ‚Äî it is the most magnificent thing I have ever hung in my home."</p><div class="rv-author"><div class="rv-av">S</div>Sarah K. ¬∑ London ¬∑ Pet Portrait</div></div>
      <div class="rv reveal"><div class="rv-stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div><p class="rv-text">"Ordered a couples portrait as an anniversary gift. She wept. The quality is extraordinary ‚Äî it genuinely looks like a painting from a museum."</p><div class="rv-author"><div class="rv-av">M</div>Marco D. ¬∑ Milan ¬∑ Couple Portrait</div></div>
      <div class="rv reveal"><div class="rv-stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div><p class="rv-text">"Got a children's portrait for my daughter's birthday. She asks to look at it every single morning. Worth every penny."</p><div class="rv-author"><div class="rv-av">A</div>Amelia T. ¬∑ New York ¬∑ Children's Portrait</div></div>
    </div>
  </div>
</div>

<!-- FAQ -->
<div class="info-section" id="faq">
  <div class="info-inner" style="max-width:680px;">
    <p class="stag reveal">FAQ</p>
    <h2 class="sh reveal">Common questions</h2>
    <div class="faq-list">
      <div class="fi reveal"><button class="fq">How does the AI generation work?</button><div class="fa"><p>We use two Grok AI models from xAI. Grok Vision analyses your photo and describes your subject in detail. Then Grok Imagine paints a full Renaissance-style portrait in the style of Rembrandt, Van Dyck, and Vermeer.</p></div></div>
      <div class="fi reveal"><button class="fq">What canvas do you print on?</button><div class="fa"><p>We print on premium 425 GSM Silveradda archival canvas ‚Äî museum-grade material used by professional galleries. It delivers exceptional colour depth, texture, and a finish that lasts decades.</p></div></div>
      <div class="fi reveal"><button class="fq">Why is there a watermark on my preview?</button><div class="fa"><p>The watermark lets you see your portrait before paying. Once your purchase is complete, we print the full-resolution, watermark-free version on archival canvas.</p></div></div>
      <div class="fi reveal"><button class="fq">What photo should I upload?</button><div class="fa"><p>A clear, well-lit, front-facing photo works best. Natural daylight and sharp focus give the best AI results. You can always retry if you're not happy with the first result.</p></div></div>
      <div class="fi reveal"><button class="fq">Where do you deliver?</button><div class="fa"><p>We ship worldwide. You enter your full delivery address at checkout. Standard delivery takes 7‚Äì10 business days.</p></div></div>
      <div class="fi reveal"><button class="fq">Can I include multiple people or pets?</button><div class="fa"><p>Yes ‚Äî upload a photo with multiple subjects. The Royal package supports up to 3 subjects with the best results.</p></div></div>
    </div>
  </div>
</div>

<footer>
  <div class="footer-inner">
    <div class="footer-logo">Pawtraits<span>.</span></div>
    <div class="footer-links">
      <a href="#how-it-works">How It Works</a>
      <a href="#reviews">Reviews</a>
      <a href="#faq">FAQ</a>
      <a href="mailto:hello@pawtraits.com">hello@pawtraits.com</a>
    </div>
  </div>
  <div class="footer-copy">¬© 2025 Pawtraits ¬∑ AI portraits powered by Grok (xAI) ¬∑ Payments secured by Stripe ¬∑ Ships worldwide</div>
</footer>

<script>
const state = {
  cat:null, catLabel:null, file:null, imageDataURL:null, imageBase64:null,
  generatedImageData:null, printifyImageId:null, printifyImageUrl:null,
  isFallback:false, pkg:null, pkgPrice:null, pkgLabel:null,
};
const catLabels = { pets:'Pet Portrait', family:'Family Portrait', children:"Children's Portrait", couples:'Couple Portrait', self:'Self-Portrait' };
const pkgDetails = {
  squire: { includes:'20√ó25 cm canvas (8√ó10 in) + digital file', shipping:'7‚Äì10 business days' },
  noble:  { includes:'30√ó40 cm canvas (12√ó16 in) + digital file', shipping:'7‚Äì10 business days' },
  royal:  { includes:'45√ó60 cm canvas (18√ó24 in) + digital file', shipping:'7‚Äì10 business days' },
};

function goToStep(n) {
  document.querySelectorAll('.step-panel').forEach(p => p.classList.remove('active'));
  document.getElementById('step-'+n).classList.add('active');
  document.querySelectorAll('.pb-step').forEach(s => {
    const sn = parseInt(s.dataset.step);
    s.classList.remove('active','done');
    if(sn<n) s.classList.add('done'); else if(sn===n) s.classList.add('active');
  });
  document.querySelector('.wizard-wrap').scrollIntoView({behavior:'smooth',block:'start'});
  if(n===6) populateCheckout();
}

function selectCat(el) {
  document.querySelectorAll('.cat-card').forEach(c => c.classList.remove('selected'));
  el.classList.add('selected');
  state.cat = el.dataset.cat; state.catLabel = catLabels[state.cat];
  document.getElementById('btn-next-1').disabled = false;
}

function handleFile(file) {
  if(!file) return;
  if(file.size > 20*1024*1024) { alert('File too large. Please upload an image under 20 MB.'); return; }
  state.file = file;
  const reader = new FileReader();
  reader.onload = e => {
    const img = new Image();
    img.onload = () => {
      const canvas = document.createElement('canvas');
      const MAX = 1024; let w = img.width, h = img.height;
      if(w>h && w>MAX){ h=Math.round(h*MAX/w); w=MAX; } else if(h>MAX){ w=Math.round(w*MAX/h); h=MAX; }
      canvas.width=w; canvas.height=h;
      canvas.getContext('2d').drawImage(img,0,0,w,h);
      const resized = canvas.toDataURL('image/jpeg',0.85);
      state.imageDataURL = resized; state.imageBase64 = resized.split(',')[1];
      document.getElementById('btn-next-2').disabled = false;
      const zone = document.getElementById('upload-zone');
      zone.style.borderColor='var(--teal)'; zone.style.background='rgba(62,207,178,.06)';
      zone.querySelector('h3').textContent='‚úì  Photo ready'; zone.querySelector('p').textContent=file.name;
    };
    img.src = e.target.result;
  };
  reader.readAsDataURL(file);
}

const uploadZone = document.getElementById('upload-zone');
uploadZone.addEventListener('dragover', e => { e.preventDefault(); uploadZone.classList.add('drag-over'); });
uploadZone.addEventListener('dragleave', () => uploadZone.classList.remove('drag-over'));
uploadZone.addEventListener('drop', e => {
  e.preventDefault(); uploadZone.classList.remove('drag-over');
  const file = e.dataTransfer.files[0];
  if(file && file.type.startsWith('image/')){ document.getElementById('photo-input').files=e.dataTransfer.files; handleFile(file); }
});

function setGenStep(n,status) {
  for(let i=1;i<n;i++){ document.getElementById('gstep-'+i).classList.remove('active'); document.getElementById('gstep-'+i).classList.add('done'); document.getElementById('gcheck-'+i).style.display='inline'; }
  for(let i=1;i<=4;i++){
    if(i===n){ document.getElementById('gstep-'+i).classList.add('active'); document.getElementById('gstep-'+i).classList.remove('done'); document.getElementById('gcheck-'+i).style.display='none'; }
    else if(i>n){ document.getElementById('gstep-'+i).classList.remove('active','done'); document.getElementById('gcheck-'+i).style.display='none'; }
  }
  document.getElementById('gen-status').textContent=status;
}

function showGenError(title,msg) {
  document.getElementById('gen-spinner').style.display='none';
  document.getElementById('gen-title').textContent='Something went wrong';
  document.getElementById('gen-status').textContent='';
  document.getElementById('gen-error-title').textContent=title;
  document.getElementById('gen-error-msg').textContent=msg;
  document.getElementById('gen-error').classList.add('visible');
}

function resetGenUI() {
  document.getElementById('gen-spinner').style.display='block';
  document.getElementById('gen-title').textContent='Analysing your photo‚Ä¶';
  document.getElementById('gen-status').textContent='Studying your subject with Grok Vision';
  document.getElementById('gen-error').classList.remove('visible');
  for(let i=1;i<=4;i++){ document.getElementById('gstep-'+i).classList.remove('active','done'); document.getElementById('gcheck-'+i).style.display='none'; }
  document.getElementById('gstep-1').classList.add('active');
}

async function startGeneration() {
  goToStep(3); resetGenUI(); state.isFallback=false;
  try {
    setGenStep(1,'Studying your subject with Grok Vision‚Ä¶');
    const t2=setTimeout(()=>setGenStep(2,'Crafting the Renaissance portrait prompt‚Ä¶'),4000);
    const t3=setTimeout(()=>{ setGenStep(3,'Painting your portrait with Grok Imagine‚Ä¶'); document.getElementById('gen-title').textContent='Painting your portrait‚Ä¶'; },7000);
    const res = await fetch('/api/generate',{
      method:'POST', headers:{'Content-Type':'application/json'},
      body:JSON.stringify({ imageBase64:state.imageBase64, imageMimeType:state.file?.type||'image/jpeg', category:state.cat, catLabel:state.catLabel }),
    });
    clearTimeout(t2); clearTimeout(t3);
    if(!res.ok){ const err=await res.json().catch(()=>({})); throw new Error(err.error||`Server error ${res.status}`); }
    const data = await res.json();
    state.generatedImageData=data.imageData; state.printifyImageId=data.printifyImageId||null; state.printifyImageUrl=data.printifyImageUrl||null;
    setGenStep(4,'Applying the finishing touches‚Ä¶');
    await delay(700);
    for(let i=1;i<=4;i++){ document.getElementById('gstep-'+i).classList.remove('active'); document.getElementById('gstep-'+i).classList.add('done'); document.getElementById('gcheck-'+i).style.display='inline'; }
    document.getElementById('gen-status').textContent='Your masterpiece is ready ‚ú¶';
    document.getElementById('gen-title').textContent='Portrait complete!';
    await delay(800);
    renderWatermarkedPreview(state.generatedImageData);
    goToStep(4);
  } catch(err) {
    showGenError('Generation failed', err.message||'An unexpected error occurred.');
  }
}

function showFallbackPreview() { state.isFallback=true; renderWatermarkedPreview(state.imageDataURL); goToStep(4); }

function renderWatermarkedPreview(imageSrc) {
  const canvas=document.getElementById('preview-canvas');
  const ctx=canvas.getContext('2d');
  const img=new Image(); img.crossOrigin='anonymous';
  img.onload=()=>{
    const maxW=400, scale=Math.min(1,maxW/img.width);
    canvas.width=Math.round(img.width*scale); canvas.height=Math.round(img.height*scale);
    const W=canvas.width, H=canvas.height;
    ctx.drawImage(img,0,0,W,H);
    ctx.fillStyle='rgba(10,5,0,0.12)'; ctx.fillRect(0,0,W,H);
    ctx.save(); ctx.font='bold 13px Arial,sans-serif'; ctx.fillStyle='rgba(255,255,255,0.18)';
    ctx.translate(W/2,H/2); ctx.rotate(-Math.PI/6);
    for(let r=-8;r<=8;r++) for(let c=-8;c<=8;c++) ctx.fillText('PAWTRAITS',c*155,r*100);
    ctx.restore();
    ctx.save(); ctx.textAlign='center'; ctx.textBaseline='middle';
    const cx=W/2,cy=H/2,pw=230,ph=44;
    ctx.fillStyle='rgba(0,0,0,0.60)'; roundRect(ctx,cx-pw/2,cy-ph/2,pw,ph,22); ctx.fill();
    ctx.strokeStyle='rgba(62,207,178,0.75)'; ctx.lineWidth=1.5; roundRect(ctx,cx-pw/2,cy-ph/2,pw,ph,22); ctx.stroke();
    ctx.fillStyle='rgba(62,207,178,0.92)'; ctx.font='bold 12px Arial,sans-serif';
    ctx.fillText('‚ú¶  PAWTRAITS  ¬∑  PREVIEW ONLY  ‚ú¶',cx,cy); ctx.restore();
    ctx.save(); ctx.fillStyle='rgba(62,207,178,0.65)'; ctx.font='9px Arial,sans-serif'; ctx.textAlign='right'; ctx.fillText('PAWTRAITS.COM',W-8,H-8); ctx.restore();
    const vign=ctx.createRadialGradient(W/2,H/2,W*0.35,W/2,H/2,W*0.75);
    vign.addColorStop(0,'transparent'); vign.addColorStop(1,'rgba(0,0,0,0.35)');
    ctx.fillStyle=vign; ctx.fillRect(0,0,W,H);
  };
  img.onerror=()=>{ if(imageSrc!==state.imageDataURL) renderWatermarkedPreview(state.imageDataURL); };
  img.src=imageSrc;
  document.getElementById('prev-cat').textContent=state.catLabel||'‚Äî';
}

function roundRect(ctx,x,y,w,h,r){
  ctx.beginPath(); ctx.moveTo(x+r,y); ctx.lineTo(x+w-r,y); ctx.quadraticCurveTo(x+w,y,x+w,y+r);
  ctx.lineTo(x+w,y+h-r); ctx.quadraticCurveTo(x+w,y+h,x+w-r,y+h); ctx.lineTo(x+r,y+h);
  ctx.quadraticCurveTo(x,y+h,x,y+h-r); ctx.lineTo(x,y+r); ctx.quadraticCurveTo(x,y,x+r,y); ctx.closePath();
}

function selectPkg(el) {
  document.querySelectorAll('.pkg-card').forEach(c=>c.classList.remove('selected'));
  el.classList.add('selected');
  state.pkg=el.dataset.pkg; state.pkgPrice=el.dataset.price; state.pkgLabel=el.querySelector('.pkg-name').textContent;
  document.getElementById('btn-next-5').disabled=false;
}

function populateCheckout() {
  const canvas=document.getElementById('preview-canvas');
  if(canvas.width>0) document.getElementById('checkout-thumb').src=canvas.toDataURL('image/jpeg',0.65);
  document.getElementById('checkout-cat').textContent=state.catLabel||'‚Äî';
  document.getElementById('checkout-pkg').textContent=state.pkgLabel||'‚Äî';
  const d=pkgDetails[state.pkg]||{};
  document.getElementById('checkout-includes').textContent=d.includes||'‚Äî';
  document.getElementById('checkout-ship').textContent=d.shipping||'‚Äî';
  document.getElementById('checkout-price').textContent=state.pkgPrice||'‚Äî';
}

async function goToStripe() {
  const btn=document.querySelector('.pay-btn');
  btn.textContent='Preparing checkout‚Ä¶'; btn.disabled=true;
  try {
    const res=await fetch('/api/checkout',{
      method:'POST', headers:{'Content-Type':'application/json'},
      body:JSON.stringify({ pkg:state.pkg, printifyImageId:state.printifyImageId, printifyImageUrl:state.printifyImageUrl, catLabel:state.catLabel }),
    });
    const data=await res.json();
    if(!res.ok||!data.url) throw new Error(data.error||'Could not create checkout session');
    window.location.href=data.url;
  } catch(err) {
    btn.textContent='Enter Delivery Details & Pay'; btn.disabled=false;
    alert('Checkout failed: '+err.message);
  }
}

function delay(ms){ return new Promise(r=>setTimeout(r,ms)); }

document.querySelectorAll('.fq').forEach(btn=>{
  btn.addEventListener('click',()=>{
    const item=btn.closest('.fi'), ans=item.querySelector('.fa'), open=item.classList.contains('open');
    document.querySelectorAll('.fi.open').forEach(i=>{ i.classList.remove('open'); i.querySelector('.fa').style.maxHeight=null; });
    if(!open){ item.classList.add('open'); ans.style.maxHeight=ans.scrollHeight+'px'; }
  });
});

const obs=new IntersectionObserver(entries=>{
  entries.forEach((e,i)=>{ if(e.isIntersecting){ setTimeout(()=>e.target.classList.add('visible'),80*i); obs.unobserve(e.target); } });
},{threshold:.1});
document.querySelectorAll('.reveal').forEach(el=>obs.observe(el));
</script>
</body>
</html>
